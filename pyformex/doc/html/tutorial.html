

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyFormex tutorial &mdash; pyFormex v0.8.4 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.8.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="pyFormex v0.8.4 documentation" href="index.html" />
    <link rel="next" title="pyFormex user guide" href="user-guide.html" />
    <link rel="prev" title="Installing pyFormex" href="install.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="user-guide.html" title="pyFormex user guide"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="install.html" title="Installing pyFormex"
             accesskey="P">previous</a> |</li>
    <li><a href="http://pyformex.org/">pyFormex Home</a> &gt;</li>
    
        <li><a href="index.html">pyFormex Documentation</a> &gt;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="cha-tutorial">
<span id="id1"></span><h1>pyFormex tutorial<a class="headerlink" href="#cha-tutorial" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This document is currently under revision!</p>
</div>
<div class="topic">
<p class="topic-title first">Abstract</p>
<p>This tutorial will guide you step by step through the most important
concepts of the pyFormex scripting language and the pyFormex Graphical
User Interface (GUI). It is intended for first time users, giving explicit
details of what to do and what to expect as result.</p>
</div>
<div class="section" id="the-philosophy">
<span id="sec-intro-tut"></span><h2>The philosophy<a class="headerlink" href="#the-philosophy" title="Permalink to this headline">¶</a></h2>
<p>pyFormex is a Python implementation of Formex algebra. Using
pyFormex, it is very easy to generate large geometrical models of 3D
structures by a sequence of mathematical transformations.  It is
especially suited for the automated design of spatial structures. But
it can also be used for other tasks, like operating on 3D geometry
obtained from other sources, or for finite element pre- and
postprocessing, or just for creating some nice pictures.</p>
<p>By writing a simple script, a large and complex geometry can be created by
copying, translating, rotating, or otherwise transforming geometrical entities.
pyFormex will interpret the script and draw what you have created.
This is clearly very different from the traditional (mostly interactive) way
of creating a geometrical model, like is done in most CAD packages.
There are some huge advantages in using pyFormex:</p>
<ul class="simple">
<li>It is especially suited for the automated design of spatial frame structures.
A dome, an arc, a hypar shell, ..., when constructed as a space frame, can be
rather difficult and tedious to draw with a general CAD program;
using scripted mathematical transformations however, it may become a
trivial task.</li>
<li>Using a script makes it very easy to apply changes in the geometry:
you simply modify the script and re-execute it. You can easily
change the value of a geometrical parameter in any way you want:
set it directly, interactively ask it from the user, calculate it from some
formula, read it from a file, etcetera.
Using CAD, you would have often have to
completely redo your drawing work. The power of scripted geometry
building is illustrated in figure <a class="reference internal" href="#fig-scallopdomes"><em>Same script, different domes</em></a>: all these
domes were created with the same script, but with different values
of some parameters.</li>
</ul>
<div class="figure align-center" id="fig-scallopdomes">
<img alt="Three scallop domes" src="_images/scallopdomes.png" />
<p class="caption">Same script, different domes</p>
</div>
<ul class="simple">
<li>At times there will be operations that are easier to perform through
an interactive Graphical User Interface (GUI). The GUI gives access
to many such functions. Especially occasional and untrained users
will benefit from it. As everything else in pyFormex, the GUI is completely
open and can be modified at will by the user&#8217;s application scripts,
to provide an interface with either extended or restricted
functionality.</li>
<li>pyformex scripts are written in the <a class="reference external" href="http://www.python.org">Python</a> programming language.
This implies that the scripts are also Python-based. It is a very
easy language to learn, and if you are interested in reading more
about it, there are good tutorials and beginner&#8217;s guides available
on the Python website (<a class="reference external" href="http://www.python.org/doc">http://www.python.org/doc</a>). However, if
you&#8217;re only using Python to write pyFormex scripts, the tutorial
you&#8217;re reading right now should be enough.</li>
</ul>
</div>
<div class="section" id="getting-started">
<span id="sec-getting-started"></span><h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Start the pyFormex GUI by entering the command <tt class="docutils literal"><span class="pre">pyformex</span></tt> in a
terminal. Depending on your instalation, there may also be a menu
item in the application menu to start pyFormex, or even a quickstart button
in the panel. Using the terminal however can still be useful,
especially in the case of errors, because otherwise the GUI might
suppress some of the error messages that normally are sent to the
terminal.</p>
</li>
<li><p class="first">Create a new pyFormex script using the
<em class="menuselection">File‣Create new script</em> option, and enter a filename
with extension <tt class="docutils literal"><span class="pre">.py</span></tt>. This will open up your favorite editor with
a pyFormex script template like the one below.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></td><td class="code"><div class="highlight"><pre><span class="c">#!/usr/bin/env pyformex --gui</span>

<span class="sd">&quot;&quot;&quot;Script Template</span>

<span class="sd">This is a template file to show the general layout of a pyFormex script.</span>
<span class="sd">In the current version, a pyFormex script should obey the following rules:</span>

<span class="sd">- file name extension is &#39;.py&#39;</span>
<span class="sd">- first (comment) line contains &#39;pyformex&#39;</span>

<span class="sd">The script starts by preference with a docstring (like this),</span>
<span class="sd">composed of a short first line, then a blank line and</span>
<span class="sd">one or more lines explaining the intention of the script.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">print</span> <span class="s">&quot;This is the pyFormex template script&quot;</span>

<span class="c"># End</span>
</pre></div>
</td></tr></table></div>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If the editor does not open, you may need to configure
the editor command:  see <a class="reference internal" href="gui.html#settings-commands"><em>Settings &#8211;&gt; Commands</em></a>.</p>
<p class="last">Make sure you are using an editor that understands Python code. Most modern
editors will give you syntax highlighting and help with indentation.</p>
</div>
<ul>
<li><p class="first">The template script shows the typical layout of a pyFormex script:</p>
<ul class="simple">
<li>The script starts with a line <tt class="docutils literal"><span class="pre">#!/usr/bin/env</span> <span class="pre">pyformex</span></tt>.</li>
<li>Then comes a multiline documentation string, contained between two <tt class="docutils literal"><span class="pre">&quot;&quot;&quot;</span></tt>
delimiters. Read it: it repeats this instructions on how a legal
pyFormex script should be structured.</li>
<li>Next are the pyFormex instructions: in this case there&#8217;s only one line.</li>
<li>The script ends with a comment line <tt class="docutils literal"><span class="pre">#</span> <span class="pre">End</span></tt>. We recommend you to do this
also. It serves as a warning for inadvertent truncation of your file.</li>
</ul>
</li>
<li><p class="first">In the status bar at the bottom of the pyFormex GUI, you will now
see the name of the script, together with a green dot. This tells
you that the script has been recognized by the system as a
pyFormex script, and is ready to run.</p>
</li>
<li><p class="first">Execute the script by selecting the <em class="menuselection">File ‣ Play</em>
menu option, or by just pushing the <img alt="button-play" src="_images/next.png" /> button in the
toolbar. In the message area just above the status bar, a line is
printed announcing the start and end of execution. Any output created
by the script during execution will be displayed in between this two
lines. As expected, the template script just prints the text from line 16
of the script.</p>
</li>
<li><p class="first">Now change the text of the string in line 16, but do not save your changes.
Execute the script again, and notice that the printed text has not changed!
This is because the editor is an external program to pyFormex, and <em>the
executed script is always the text as read from file</em>, not necessarily equal
to what is displayed in your editor.</p>
<p>Save the script, run it again, and you will see the output has changed.</p>
</li>
<li><p class="first">Next, change the text of the script to look like the one below, and save it as
<tt class="docutils literal"><span class="pre">example1.py</span></tt>. Again, note that the editor and pyFormex are separate
programs, and saving the script does not change the name of the current
script in pyFormex.</p>
<p>Selecting an existing script file for execution in pyFormex is done with
the <em class="menuselection">File ‣ Open</em> option. Open the <tt class="docutils literal"><span class="pre">example1.py</span></tt> file
you just saved and check that its name is indeed displayed in the status bar.
You can now execute the script if you want, but it will not produce anything
visible. We&#8217;ll learn you how to visualize geometry later on.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre>1
2
3
4
5
6</pre></td><td class="code"><div class="highlight"><pre><span class="c">#!/usr/bin/env pyformex --gui</span>
<span class="sd">&quot;&quot;&quot;Example 1&quot;&quot;&quot;</span>

<span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]])</span>

<span class="c"># End</span>
</pre></div>
</td></tr></table></div>
</li>
<li><p class="first">Exit pyFormex (using the <em class="menuselection">File ‣ Exit</em>) and then restart
it. You should again see the <tt class="docutils literal"><span class="pre">example1.py</span></tt> displayed as the current script.
On exit, pyFormex stores your last script name, and on restart it prepares
to run it again. You can also easily select one the most recent scripts you
used from the <em class="menuselection">File ‣ History</em> option. Select the oldest
(bottom) one. Then close all your editor windows.</p>
</li>
<li><p class="first">Open the <tt class="docutils literal"><span class="pre">example1.py</span></tt> again, either using <em class="menuselection">File ‣ Open</em>
or <em class="menuselection">File ‣ History</em>. The script will not be loaded into your
editor. That is becaused often you will just want to <em>run</em> the script, not
<em>change</em> it. Use the <em class="menuselection">File ‣ Edit</em> option to load the
current script into the editor.</p>
</li>
</ul>
<p>Now that you know how to load, change and execute scripts in pyFormex, we&#8217;re
all set for exploring its power. But first, let&#8217;s introduce you to
some basic Python and NumPy concepts. If you are already familiar with
them, you can just skip these sections.</p>
</div>
<div class="section" id="some-basic-python-concepts">
<span id="sec-intro-python"></span><h2>Some basic Python concepts<a class="headerlink" href="#some-basic-python-concepts" title="Permalink to this headline">¶</a></h2>
<p>pyFormex is written in the Python language, and Python is also the
scripting language used by pyFormex. Since the whole intent of pyFormex
is to generate geometrical structures from scripts, you will at least
need to have some basic knowledge of Python before you can use it for
your own projects.</p>
<p>The <a class="reference external" href="http://www.python.org/doc">Python documentation</a> website contains a variety of good
documents to introduce you. If you are new to Python, but have already
some programming experience, the <a class="reference external" href="http://docs.python.org/tutorial">Python tutorial</a> may be a good
starting point. Or else, you can take a look at one of the other beginners&#8217;
guides. Stick with the Python 2.x documentation for now. Though
pyFormex might one day use Python 3.x, we are still far off that
day, because all the underlying packages need to be converted to
Python 3 first.</p>
<p>Do not be afraid of having to learn a new programming language. Python is
known as own of the easiest languages to get started with: just a few basic
concepts suffice to produce quite powerful scripts. Most developers and users of
pyFormex have started without any knowledge of Python.</p>
<p>For the really impatient who do not want to go through the <a class="reference external" href="http://docs.python.org/tutorial">Python
tutorial</a> before diving into pyFormex, we have gathered hereafter
some of the most important Python concepts, hopefully enabling you to
continue with this tutorial.</p>
<p>Here is a small example Python script.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></td><td class="code"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;Python intro</span>

<span class="sd">A short introduction to some aspects of the Python programming language</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">for</span> <span class="n">light</span> <span class="ow">in</span> <span class="p">[</span> <span class="s">&#39;green&#39;</span><span class="p">,</span><span class="s">&#39;yellow&#39;</span><span class="p">,</span><span class="s">&#39;red&#39;</span><span class="p">,</span><span class="s">&#39;black&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">light</span> <span class="o">==</span> <span class="s">&#39;red&#39;</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;stop&#39;</span>
    <span class="k">elif</span> <span class="n">light</span> <span class="o">==</span> <span class="s">&#39;yellow&#39;</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;brake&#39;</span>
    <span class="k">elif</span> <span class="n">light</span> <span class="o">==</span> <span class="s">&#39;green&#39;</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;drive&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;THE LIGHT IS BROKEN!&#39;</span>



<span class="n">appreciation</span> <span class="o">=</span> <span class="p">{</span> <span class="mf">0</span><span class="p">:</span> <span class="s">&#39;not driving&#39;</span><span class="p">,</span> <span class="mf">30</span><span class="p">:</span><span class="s">&#39;slow&#39;</span><span class="p">,</span> <span class="mf">60</span><span class="p">:</span><span class="s">&#39;normal&#39;</span><span class="p">,</span> <span class="mf">90</span><span class="p">:</span><span class="s">&#39;dangerous&#39;</span><span class="p">,</span> <span class="mf">120</span><span class="p">:</span><span class="s">&#39;suicidal&#39;</span><span class="p">}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">5</span><span class="p">):</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="mf">30</span><span class="o">*</span><span class="n">i</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">. Driving at speed </span><span class="si">%s</span><span class="s"> is </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">speed</span><span class="p">,</span><span class="n">appreciation</span><span class="p">[</span><span class="n">speed</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<ul>
<li><p class="first">A &#8216;#&#8217; starts a comment: the &#8216;#&#8217;, and anything following it on the same line,
is disregarded. A Python script typically starts with a comment line like
line 1 of the above script.</p>
</li>
<li><p class="first">Strings in Python can be delimited either by single quotes (&#8216;),
double quotes (&#8221;) or by triple double quotes (&#8220;&#8221;&#8221;). The starting and
ending delimiters have to be equal though. Strings in triple quotes
can span several lines, like the string on lines 2-5.</p>
</li>
<li><p class="first">Indentation is essential. Indentation is Python&#8217;s way of
grouping statements. In small, sequential scripts,
indentation is not needed and you should make sure that you start
each new line in the first column.
An <tt class="docutils literal"><span class="pre">if</span></tt> test or a <tt class="docutils literal"><span class="pre">for</span></tt> loop will however need indentation to
mark the statement(s) inside the condition or loop.
Thus, in the example, lines 8-15 are the block of statements that are
executed repeatedly under the <tt class="docutils literal"><span class="pre">for</span></tt> loop construct in line 7.
Notice that the condition and loop statements end with a &#8216;:&#8217;.</p>
<p>You should make sure that statements belonging to the same block are
indented consistently.
We advice you not to use tabs for indenting. A good practice
commonly followed by most Python programmers is to indent with 4
spaces.</p>
<p>The indentation makes Python code easy to read for humans. Most modern
editors will recognize Python code and help you with the indentation.</p>
</li>
<li><p class="first">Variables in Python do not need to be declared before using them. In
fact, Python has no variables, only typed objects. An assignment is
just the binding of a name to an object. That binding can be changed
at each moment by a new assignment to the same name.</p>
</li>
<li><p class="first">Sequences of objects can be grouped in tuples or lists, and
individual items of them are accessed by an index starting from 0.</p>
</li>
<li><p class="first">Function definitions can use both positional arguments and keyword arguments,
but the keyword arguments mus follow the positional arguments.
The order in which keyword arguments are specified is not important.</p>
</li>
<li><p class="first">You can used names defines in other modules, but you need to import
those first. This can be done by importing the whole module and then
using a name relative to that module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">mymodule</span>
<span class="k">print</span> <span class="n">mymodule</span><span class="o">.</span><span class="n">some_variable</span>
</pre></div>
</div>
<p>or you can import specific names from a module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">mymodule</span> <span class="kn">import</span> <span class="n">some_variable</span>
<span class="k">print</span> <span class="n">some_variable</span>
</pre></div>
</div>
<p>or you can import everything from a module (not recommended, because
you can easily clutter your name space):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">mymodule</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">print</span> <span class="n">some_variable</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="some-basic-numpy-concepts">
<span id="sec-intro-numpy"></span><h2>Some basic NumPy concepts<a class="headerlink" href="#some-basic-numpy-concepts" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This section still needs to be written!</p>
</div>
<p>Numerical Python (or NumPy for short) is an extension to the Python language
providing efficient operations on large (numerical) arrays. relies heavily on
NumPy, and most likely you will need to use some NumPy functions in your
scripts. As NumPy is still quite young, the available documentation is not so
extensive yet. Still, the tentative NumPy
tutorial <a class="reference external" href="http://www.scipy.org/Tentative_NumPy_Tutorial">http://www.scipy.org/Tentative_NumPy_Tutorial</a> already provides the
basics.</p>
<p>If you have ever used some other matrix language, you will find a lot of similar
concepts in NumPy.</p>
<p>To do: Introduce the (for users) most important NumPy concepts.</p>
<p id="index-0">pyFormex uses the NumPy <tt class="xref py py-class docutils literal"><span class="pre">ndarray</span></tt> as implementation of fast
numerical arrays in Python.</p>
</div>
<div class="section" id="the-formex-data-model">
<span id="sec-formex"></span><h2>The Formex data model<a class="headerlink" href="#the-formex-data-model" title="Permalink to this headline">¶</a></h2>
<p id="index-1">The most important geometrical object in pyFormex is the
<tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> class. A <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> (plural:Formices) can
describe a variety of geometrical objects: points, lines, surfaces,
volumes. The most simple geometrical object is the point, which in
three dimensions is only determined by its coordinates <tt class="docutils literal"><span class="pre">(x,y,z)</span></tt>,
which are numbered <tt class="docutils literal"><span class="pre">(0,1,2)</span></tt> in pyFormex to be consistent with
Python and NumPy indexing.  Higher order geometrical objects are
defined as a collection of points.  The number of points of an object
is called the <em>plexitude</em> of the object.</p>
<p id="index-2">A Formex is a collection of geometrical objects of the same plexitude. The
objects in the collection are called the <em>elements</em> of the <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt>. A
<tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> whose elements have plexitude <img class="math" src="_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> is also called an
<img class="math" src="_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>-plex <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt>. Internally, the coordinates of the points are
stored in a NumPy <tt class="xref py py-class docutils literal"><span class="pre">ndarray</span></tt>  with three dimensions. The coordinates of a
single point are stored along the last axis (2) of the <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt>; all the
points of an element are stored along the second axis (1); different elements
are stored along the first axis (0) of the <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt>. The figure
<a class="reference internal" href="#fig-formex"><em>The structure of a Formex</em></a> schematizes the structure of a <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt>.</p>
<div class="figure align-center" id="fig-formex">
<img alt="The structure of a Formex" src="_images/Formex.png" />
<p class="caption">The structure of a Formex</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The beginning user should be aware not to confuse the three axes of
a <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> with the axes of the 3D space. Both are numbered
0..2. The three coordinate axes form the components of the last
axis of a Formex.</p>
</div>
<p>For simplicity of the implemented algorithms, internally pyFormex
only deals with 3D geometry. This means that the third axis of a
<tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> always has length 3. You can however import 2D
geometry: all points will be given a third coordinate
<img class="math" src="_images/math/5510380da19a236624ef45908d2da469f892b03e.png" alt="z=0.0"/>. If you restrict your operations to transformations in
the <img class="math" src="_images/math/e53b1fe25be1c679117fb44a6a886fe1247d189a.png" alt="(x,y)"/>-plane, it suffices to extract just the first two
coordinates to get the transformed 2D geometry.</p>
<p>The <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> object <tt class="docutils literal"><span class="pre">F</span></tt> can be indexed just like a <img class="math" src="_images/math/d915c944b3a7f2f094b4ceb88eaa658f3b8c754d.png" alt="NumPy"/>
numerical array: <tt class="docutils literal"><span class="pre">F[i]</span></tt> returns the element with index <img class="math" src="_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/> (counting
from <img class="math" src="_images/math/bc1f9d9bf8a1b606a4188b5ce9a2af1809e27a89.png" alt="0"/>). For a <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> with plexitude <img class="math" src="_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>, the result will
be an array with shape <img class="math" src="_images/math/5c541ab0141339afc82e2de9722cea4a35199b32.png" alt="(n,3)"/>, containing all the points of the element.
Further, <tt class="docutils literal"><span class="pre">F[i][j]</span></tt> will be a <img class="math" src="_images/math/194898d001654fd8f1e45866c351b72f3abf7011.png" alt="(3,)"/>-shaped array containing the
coordinates of point <img class="math" src="_images/math/8122aa89ea6e80784c6513d22787ad86e36ad0cc.png" alt="j"/> of element <img class="math" src="_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>. Finally, <tt class="docutils literal"><span class="pre">F[i][j][k]</span></tt> is
a single floating point value representing one coordinate of that point.</p>
<p>In the following sections of this tutorial, we will first learn you
how to create simple geometry using the Formex data model and how to
use the basic pyFormex interface functions. The real power of the
<tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> class will then be established starting from the section <a class="reference internal" href="#sec-transform"><em>Transforming a Formex</em></a>.</p>
</div>
<div class="section" id="creating-a-formex">
<span id="sec-create-formex"></span><h2>Creating a Formex<a class="headerlink" href="#creating-a-formex" title="Permalink to this headline">¶</a></h2>
<p>There are many, many ways to create <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> instances in your
scripts.  Most of the geometrical operations and transformations in
pyFormex return geometry as a <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt>. But how do you create
a new geometric structure from simple coordinate data? Well, there are
several ways to do that too, and we&#8217;ll introduce them one by one.</p>
<div class="section" id="direct-input-of-structured-coordinate-data">
<span id="subsec-direct-input"></span><h3>Direct input of structured coordinate data<a class="headerlink" href="#direct-input-of-structured-coordinate-data" title="Permalink to this headline">¶</a></h3>
<p>The most straightforward way to create a Formex is by directly
specifying the coordinates of the points of all its elements in a way
compatible to creating a 3D <tt class="xref py py-class docutils literal"><span class="pre">ndarray</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]])</span>
</pre></div>
</div>
<p>The data form a nested list of three levels deep. Each innermost level list
holds the coordinates of a single point. There are four of them: [0.,0.], [1.,0.], [1.,1.] and [0.,1.]. Remark that we left out the third (z) coordinate and it will be set equal to zero. Also, though the values are integer, we added a dot
to force floating point values.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Python by default uses integer math on integer arguments!
We advice you to always write the decimal point in values that initialize
variables that can have floating point values, such as lengths, angles,
thicknesses. Use integer values only to initialize variables that can
only have an integer value, such as the number of elements.</p>
</div>
<p>The second list level groups the points into elements. In this case
there are two elements, each containing two points. The outermost list
level then is the <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt>: it has plexitude 2 and contains 2
elements.  But what geometrical entities does this represent? The
plexitude alone does not specify what kind of geometric objects we are
dealing about. A 2-plex element would presumably represent a straight
line segment between two points in space, but it could just as well be
used to represent a sphere (by its center and a point on the surface)
or a plane (by a point in the plane and the direction of the normal).</p>
<p>By default, pyFormex will interprete the plexitude as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Plexitude</th>
<th class="head">Geometrical interpretation</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>1</td>
<td>Points</td>
</tr>
<tr><td>2</td>
<td>Straight line segments</td>
</tr>
<tr><td>3</td>
<td>Triangles</td>
</tr>
<tr><td>4 or higher</td>
<td>Polygons (possibly nonplanar)</td>
</tr>
</tbody>
</table>
<p>We will see later how to override this default. For now, let&#8217;s draw Formices
with the default. Go back to the <tt class="docutils literal"><span class="pre">example1.py</span></tt> script in your editor, containing the line above, and add the <tt class="docutils literal"><span class="pre">draw(F)</span></tt> instruction to make it look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]])</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>Save the script and execute it in pyFormex. You will see the following picture
appear in the canvas.</p>
<div class="figure align-center" id="fig-parallel">
<img alt="Two parallel lines" src="_images/parallel.png" />
<p class="caption">Two parallel lines</p>
</div>
<p>Now let&#8217;s remove the two central &#8216;]&#8217; and &#8216;[&#8216; brackets in the first line:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]])</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">blue</span><span class="p">)</span>
</pre></div>
</div>
<p>With the same data we have now created a 4-plex Formex with only one element.
Execute the script again (do not forget to save it first) and you will see
a square. Note that the draw command allows you to specify a color.</p>
<div class="figure align-center" id="fig-square">
<img alt="A square" src="_images/square.png" />
<p class="caption">A square.</p>
</div>
<p>But wait a minute! Does this represent a square surface, or just the four lines constituting the circumference of the square? Actually, it is a square surface, but since the pyFormex GUI by default displays in wireframe mode, unless you have changed it, you will only see the border of the square. You can make surfaces and solids get fully rendered by selecting the <em class="menuselection">Viewport ‣ Render Mode ‣ Flat</em> option or using the shortcut <img alt="button-flat" src="_images/flat.png" /> button in the toolbar.
You will then see</p>
<div class="figure align-center" id="fig-square-filled">
<img alt="A filled square" src="_images/square_filled.png" />
<p class="caption">The square in smooth rendering.</p>
</div>
<p>pyFormex by default uses wireframe rendering, because in a fully
rendered mode many details are obscured. Switch back to wireframe
mode using the <em class="menuselection">Viewport ‣ Render Mode ‣
Wireframe</em> menu option or <img alt="button-wireframe" src="_images/wireframe.png" /> toolbar button.</p>
<p>Now suppose you want to define a Formex representing the four border
lines of the square, and not the surface inside that
border. Obviously, you need a 4 element 2-plex Formex, using data
structured like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]])</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">blue</span><span class="p">,</span><span class="n">clear</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Try it, and you will see an image identical to the earlier figure
<a class="reference internal" href="#fig-square"><em>A square.</em></a>.
But now this image represents four straight lines, while the same
image formerly represented a square plane surface.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When modeling geometry, always be aware that what you
think you see is not necessarily what it really is!</p>
</div>
<p>The <tt class="docutils literal"><span class="pre">clear=True</span></tt> option in the draw statement makes sure the screen
is cleared before drawing. By default the pyFormex draw
statement does not clear the screen but just adds to what was already
drawn. You can make the <tt class="docutils literal"><span class="pre">clear=True</span></tt> option the default from the
<em class="menuselection">Viewport ‣ Drawing Options</em> menu.  Do this now before continuing.</p>
<p>Changing the rendering mode, the perspective and the viewpoint can
often help you to find out what the image is really representing.
But interrogating the Formex data itself is the definite way to make sure:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]])</span>
<span class="k">print</span> <span class="n">F</span><span class="o">.</span><span class="n">shape</span><span class="p">()</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]])</span>
<span class="k">print</span> <span class="n">F</span><span class="o">.</span><span class="n">shape</span><span class="p">()</span>
</pre></div>
</div>
<p>This will print the length of the three axes of the coordinate array. In
the first case you get <tt class="docutils literal"><span class="pre">(1,</span> <span class="pre">4,</span> <span class="pre">3)</span></tt> (1 element of plexitude 4),
while the second one gives <tt class="docutils literal"><span class="pre">(2,</span> <span class="pre">2,</span> <span class="pre">3)</span></tt> (2 elements of plexitude 2).</p>
<p>You can also print the whole Formex, using <tt class="docutils literal"><span class="pre">print</span> <span class="pre">F</span></tt>, giving you the
coordinate data in a more readable fashion than the list input. The
last example above will yield:
<tt class="docutils literal"><span class="pre">{[0.0,0.0,0.0;</span> <span class="pre">1.0,0.0,0.0],</span> <span class="pre">[1.0,1.0,0.0;</span> <span class="pre">0.0,1.0,0.0]}</span></tt>.
In the output, coordinates are separated by commas and points by
semicolons. Elements are contained between brackets and the full
Formex is placed inside braces.</p>
<p>Until now we have only dealt with plane structures, but 3D structures
are as easy to create from the coordinate data. The following Formex
represents a pyramid defined by four points (a tetrahedron):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]],</span><span class="n">eltype</span><span class="o">=</span><span class="s">&#39;tet4&#39;</span><span class="p">)</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>Depending on your current rendering mode, this will produce an image
like one of the following:</p>
<div class="figure align-center" id="fig-tetraeder">
<img alt="The tetrahedron in wireframe and smoothwire rendering" src="_images/tetraeder.png" />
<p class="caption">The tetrahedron in wireframe and smoothwire (transparent) rendering</p>
</div>
<p>The smoothwire mode can be set from the <em class="menuselection">Viewport ‣
Render Mode ‣ Smoothwire</em> option or the <img alt="button-smoothwire" src="_images/smoothwire.png" />
button. The transparent mode can be toggled using the <img alt="button-transparent" src="_images/transparent.png" />
button.</p>
<p>Hold down the left mouse button and move the mouse: the pyramid will
rotate. In the same way, holding down the rigth button will zoomin and
out. Holding down the middle button (possibly the mouse wheel, or the
left and right button together) will move the pyramid over the canvas.
Practice a bit with these mouse manipulations, until you get a feeling of what
they do.
All these mouse operations do not change the coordinates of the
structure: they just change the way you&#8217;re looking at it. You can
restore the default view with the <em class="menuselection">Views ‣ Front</em>
menu or the <img alt="button-front" src="_images/front.png" /> button.</p>
<p>The default installation of pyFormex provides seven default views:
<tt class="docutils literal"><span class="pre">Front</span></tt>, <tt class="docutils literal"><span class="pre">Back</span></tt>, <tt class="docutils literal"><span class="pre">Left</span></tt>, <tt class="docutils literal"><span class="pre">Right</span></tt>, <tt class="docutils literal"><span class="pre">Top</span></tt>, <tt class="docutils literal"><span class="pre">Bottom</span></tt> and
<tt class="docutils literal"><span class="pre">Iso</span></tt>. They can be set from the <em class="menuselection">Views</em> menu items or
the corresponding view buttons in the toolbar.  The default <tt class="docutils literal"><span class="pre">Front</span></tt>
corresponds to the camera looking in the <img class="math" src="_images/math/5f131a63bd792d941d6f8fd7da6ffb14f86989bf.png" alt="-z"/> direction, with
the <img class="math" src="_images/math/26eeb5258ca5099acf8fe96b2a1049c48c89a5e6.png" alt="x"/> axis oriented to the right and the <img class="math" src="_images/math/092e364e1d9d19ad5fffb0b46ef4cc7f2da02c1c.png" alt="y"/> axis
upward.</p>
<p>We explicitely added the element type <tt class="docutils literal"><span class="pre">tet4</span></tt> when creating the
pyramid. Without it, pyFormex would have interpreted the 4-plex Formex
as a quadrilateral (though in this case a non-planar one).</p>
</div>
<div class="section" id="using-the-pattern-or-mpattern-functions">
<span id="subsec-using-patterns"></span><h3>Using the <tt class="xref py py-func docutils literal"><span class="pre">pattern()</span></tt> or <tt class="xref py py-func docutils literal"><span class="pre">mpattern()</span></tt> functions<a class="headerlink" href="#using-the-pattern-or-mpattern-functions" title="Permalink to this headline">¶</a></h3>
<p>In the previous examples the Formices were created by directly
specifying the coordinate data. That is fine for small structures, but
quickly becomes cumbersome when the structures get larger.
The <tt class="xref py py-func docutils literal"><span class="pre">pattern()</span></tt> and <tt class="xref py py-func docutils literal"><span class="pre">mpattern()</span></tt> functions reduce the amount of
input needed to create a Formex from scratch.</p>
<p>Both functions create a series of points from a simple
string. Each character of the string is interpreted either as a unit
step in one of the coordinate directions, or as some other simple
action. These functions are thus very valuable in creating geometry
where the points lie on a regular grid.</p>
<p>The first point of the list is [0,0,0]. Each character from the input
string is interpreted as a code specifying how to move to the next
point.  Currently defined are the following codes: 0 = goto origin
[0,0,0], 1..8 move in the x,y plane, 9 remains at the same place.
When looking at the plane with the x-axis to the right and the y-axis
up, 1 = East, 2 = North, 3 = West, 4 = South, 5 = NE, 6 = NW, 7 = SW,
8 = SE.
Adding 16 to the ordinal of the character causes an extra move of +1 in the
z-direction. Adding 48 causes an extra move of -1. This means that
&#8216;ABCDEFGHI&#8217;, resp. &#8216;abcdefghi&#8217;, correspond with &#8216;123456789&#8217; with an
extra z = +/- 1. This gives the following schema:</p>
<div class="highlight-python"><pre>    z+=1             z unchanged            z -= 1

F    B    E          6    2    5         f    b    e
     |                    |                   |
     |                    |                   |
C----I----A          3----9----1         c----i----a
     |                    |                   |
     |                    |                   |
G    D    H          7    4    8         g    d    h</pre>
</div>
<p>The special character &#8216;/&#8217; can be put before any character to make the
move without making a connection.  The effect of any other character
is undefined.</p>
<p>The <tt class="xref py py-func docutils literal"><span class="pre">pattern()</span></tt> function creates a straight line segment between
each pair of subsequent points, and thus results in a 2-plex Formex.
Here&#8217;s an example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">pattern</span><span class="p">(</span><span class="s">&#39;1234&#39;</span><span class="p">))</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>It creates the same circumference of a unit square as above (see
figure <a class="reference internal" href="#fig-square"><em>A square.</em></a>), but is much simpler than the explicit
specification of the coordinates we used before.
Figure <a class="reference internal" href="#fig-patterns"><em>Images generated from the patterns &#8216;127&#8217;, &#8216;11722&#8217; and &#8216;22584433553388&#8217;</em></a> shows some more examples.</p>
<div class="figure align-center" id="fig-patterns">
<img alt="Images generated from patterns" src="_images/patterns.png" />
<p class="caption">Images generated from the patterns &#8216;127&#8217;, &#8216;11722&#8217; and &#8216;22584433553388&#8217;</p>
</div>
<p>The <tt class="xref py py-func docutils literal"><span class="pre">mpattern()</span></tt> function is more general than <tt class="xref py py-func docutils literal"><span class="pre">pattern()</span></tt> in that it allows the
creation of Formices of any plexitude. Each subsequent point is added
to the same element, until a &#8216;-&#8216; character or the end of the string is
found. The following example creates a square:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">mpattern</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">))</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>If it comes as a surprise that there are only 3 characters for a
square, remember that the origin is always added as first point.</p>
<p>Some simple wireframe patterns are defined in <tt class="xref py py-mod docutils literal"><span class="pre">simple.py</span></tt> and are
ready for use.  These pattern strings are stacked in a dictionary called
&#8216;Pattern&#8217;. Items of this dictionary can be accessed like
<tt class="docutils literal"><span class="pre">Pattern['cube']</span></tt>. They still need to be processed by the
<tt class="xref py py-func docutils literal"><span class="pre">pattern()</span></tt> function to produce coordinates:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env pyformex</span>
<span class="kn">from</span> <span class="nn">simple</span> <span class="kn">import</span> <span class="n">Pattern</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">pattern</span><span class="p">(</span><span class="n">Pattern</span><span class="p">[</span><span class="s">&#39;cube&#39;</span><span class="p">]))</span>
<span class="k">print</span> <span class="n">F</span><span class="o">.</span><span class="n">shape</span><span class="p">()</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">blue</span><span class="p">,</span><span class="n">view</span><span class="o">=</span><span class="s">&#39;iso&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-cube">
<img alt="A wireframe cube" src="_images/cube.png" />
<p class="caption">A wireframe cube</p>
</div>
<p>The printed out shape of the Formex is <tt class="docutils literal"><span class="pre">(12,2,3)</span></tt>, confirming that
what we have created here is not a 3D solid cube, nor the planes bounding
that cube, but merely twelve straight line segments forming the edges
of a cube.</p>
<p>The <tt class="docutils literal"><span class="pre">view='iso'</span></tt> option in the draw statement rotates the camera so
that it looks in the [-1,-1,-1] direction. This is one of the
predefined viewing directions and can also be set from the
<em class="menuselection">Views</em> menu or using the <img alt="button-iso" src="_images/iso.png" /> button.</p>
<p>While the <tt class="xref py py-func docutils literal"><span class="pre">pattern()</span></tt> and <tt class="xref py py-func docutils literal"><span class="pre">mpattern()</span></tt> functions can
only generate points lying on a regular cartesian grid, pyFormex provides
a wealth of transformation functions to move the points to other
locations after they were created.
Also, the <tt class="xref py py-mod docutils literal"><span class="pre">Turtle</span></tt> plugin module provides a more general mechanism to
create planar wireframe structures.</p>
</div>
<div class="section" id="reading-coordinates-from-a-file-or-a-string">
<span id="subsec-reading-from-file-or-string"></span><h3>Reading coordinates from a file or a string<a class="headerlink" href="#reading-coordinates-from-a-file-or-a-string" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you want to read the coordinates from a file, rather
than specifying them directly in your script.
This is especially handy
if you want to import geometry from some other program that can not
export data in a format that is understood by pyFormex. There usually is a
way to write the bare coordinates to a file, and the pyFormex
scripting language provides all the necessary tools to read them back.</p>
<p>As an example, create (in the same folder where you store your
scripts) the text file <tt class="docutils literal"><span class="pre">square.txt</span></tt> with the following contents:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span>  <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span>  <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span>  <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span>
<span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span>  <span class="mf">2</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span>  <span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span>
<span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span>
</pre></div>
</div>
<p>Then create and execute the following script.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env pyformex</span>
<span class="n">chdir</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="s">&#39;square.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;,&#39;</span><span class="p">,</span><span class="n">nplex</span><span class="o">=</span><span class="mf">4</span><span class="p">)</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>It will generate two squares, as shown in the figure <a class="reference internal" href="#fig-twosquares"><em>Two squares with coordinates read from a file</em></a>.</p>
<div class="figure align-center" id="fig-twosquares">
<img alt="Two squares read from file" src="_images/twosquares.png" />
<p class="caption">Two squares with coordinates read from a file</p>
</div>
<p>The <tt class="docutils literal"><span class="pre">chdir(__file__)</span></tt> statement sets your working
directory to the directory where the script is located, so that the filename
can be specified without adding the full pathname.
The <tt class="xref py py-meth docutils literal"><span class="pre">Formex.fromfile()</span></tt> call reads the coordinates (as specified,
separated by &#8216;,&#8217;) from the file and groups them into elements of the specified
plexitude (4). The grouping of coordinates on a line is irrelevant:
all data could just as well be given on a single line, or with just one value
per line. The separator character can be accompanied by extra
whitespace. Use a space character if your data are only separated by
whitespace.</p>
<p>There is a similar <tt class="xref py py-meth docutils literal"><span class="pre">Formex.fromstring()</span></tt> method, which reads
coordinates directly from a string in the script.
If you have a lot of coordinates to specify, this may be far more easy
than using the list formatting.
The following script yields the same result as the above one:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env pyformex</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">0 0 0  0 1 0  1 1 0  1 0 0</span>
<span class="s">1 1 0  2 1 0  2 2 0  1 2 0</span>
<span class="s">&quot;&quot;&quot;</span><span class="p">,</span><span class="n">nplex</span><span class="o">=</span><span class="mf">4</span><span class="p">)</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we used the default separator, which is a space.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure to use <tt class="xref py py-meth docutils literal"><span class="pre">Formex.fromfile()</span></tt>, to distinguish it from
<tt class="xref py py-meth docutils literal"><span class="pre">Coords.fromfile()</span></tt> and <tt class="xref py py-meth docutils literal"><span class="pre">numpy.fromfile()</span></tt>.</p>
</div>
</div>
</div>
<div class="section" id="concatenation-and-lists-of-formices">
<span id="sec-concatenation-and-lists"></span><h2>Concatenation and lists of Formices<a class="headerlink" href="#concatenation-and-lists-of-formices" title="Permalink to this headline">¶</a></h2>
<p>Multiple Formices can be concatenated to form one new Formex. There
are many ways to do this, but the simplest is to use the &#8216;+&#8217; or
<tt class="docutils literal"><span class="pre">+=</span></tt> operator. Notice the diffference: the <tt class="docutils literal"><span class="pre">+</span></tt> operator does not
changing any of the arguments, but the <tt class="docutils literal"><span class="pre">+=</span></tt> operator adds the second
argument to the first, changing its definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">pattern</span><span class="p">(</span><span class="s">&#39;1234&#39;</span><span class="p">))</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">pattern</span><span class="p">(</span><span class="s">&#39;5&#39;</span><span class="p">))</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">F</span> <span class="o">+</span> <span class="n">G</span>
<span class="n">draw</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
<p>displays the same Formex as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">+=</span> <span class="n">G</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>but in the latter case, the original definition of <tt class="docutils literal"><span class="pre">F</span></tt> is lost.</p>
<p>The <tt class="docutils literal"><span class="pre">+=</span></tt> operator is one of the very few operations that
change an existing Formex. Nearly all other operations return a
resulting Formex without changing the original ones.</p>
<p>Because a Formex has a single plexitude and element type,
concatenation is restricted to Formices of the same plexitude and with
the same <tt class="xref py py-attr docutils literal"><span class="pre">eltype</span></tt>. If you want to handle structures with
elements of different plexitude as a single object, you have to group
them in a list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">pattern</span><span class="p">(</span><span class="s">&#39;1234&#39;</span><span class="p">))</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.</span><span class="p">])</span>
<span class="n">H</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">]</span>
<span class="n">draw</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">red</span><span class="p">)</span>
</pre></div>
</div>
<p>This draws the circumference of a unit square (F: plexitude 2) and the
center point of the square (G: plexitude 1), both in red.</p>
<div class="figure align-center" id="fig-square-center">
<img alt="A square and its center point" src="_images/square_center.png" />
<p class="caption">A square and its center point.</p>
</div>
</div>
<div class="section" id="formex-property-numbers">
<span id="sec-propnr"></span><h2>Formex property numbers<a class="headerlink" href="#formex-property-numbers" title="Permalink to this headline">¶</a></h2>
<p>Apart from the coordinates of its points, a <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> object can
also store a set of property numbers. This is a set of integers, one
for every element of the Formex. The property numbers are stored in an
attribute <tt class="xref py py-attr docutils literal"><span class="pre">prop</span></tt> of the Formex.  They can be set, changed or
deleted, and be used for any purpose the user wants, e.g. to number
the elements in a different order than their appearence in the
coordinate array. Or they can be used as pointers into a large
database that stores all kind of properties for that element. Just
remember that a Formex either has no property numbers, or a complete
set of numbers: one for every element.</p>
<p>Property numbers can play an important role in the modeling process, because
they present some means of tracking how the resulting Formex was created.
Indeed, each transformation of a Formex that preserves its structure, will also
preserve the property numbers. Concatenation of Formices with property numbers
will also concatenate the property numbers. If any of the concatenated Formices
does not have property numbers, it will receive value 0 for all its elements. If
all concatenated Formices are without properties, so will be the resulting
Formex.</p>
<p>On transformations that change the structure of the Formex, such as
replication, each element of the created Formex will get the property
number of the Formex element it was generated from.</p>
<p>To add properties to a Formex, use the
<tt class="xref py py-meth docutils literal"><span class="pre">setProp()</span></tt> method. It ensures that the property array is generated with
the correct type and shape. If needed, the supplied values are repeated to
match the number of elements in the Formex.
The following script creates four triangles, the first and third get
property number 1, the second and fourth get property 3.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">mpattern</span><span class="p">(</span><span class="s">&#39;12-34-14-32&#39;</span><span class="p">))</span>
<span class="n">F</span><span class="o">.</span><span class="n">setProp</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">3</span><span class="p">])</span>
<span class="k">print</span> <span class="n">F</span><span class="o">.</span><span class="n">prop</span>   <span class="c"># --&gt; [1 3 1 3]</span>
</pre></div>
</div>
<p>As a convenience, you can also specify the property numbers as a
second argument to the Formex constructor.
Once the properties have been created, you can safely change
individual values by directly accessing the <tt class="xref py py-attr docutils literal"><span class="pre">prop</span></tt> attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">mpattern</span><span class="p">(</span><span class="s">&#39;12-34-14-32&#39;</span><span class="p">),[</span><span class="mf">1</span><span class="p">,</span><span class="mf">3</span><span class="p">])</span>
<span class="n">F</span><span class="o">.</span><span class="n">prop</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4</span>
<span class="k">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">prop</span><span class="p">)</span>   <span class="c"># --&gt; [1 3 1 4]</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">drawNumbers</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>When you draw a Formex with property numbers using the default draw
options (i.e. no color specified), pyFormex will use the property
numbers as indices in a color table, so different properties are shown
in different colors. The default color table has eight colors:
<tt class="docutils literal"><span class="pre">[black,</span> <span class="pre">red,</span> <span class="pre">green,</span> <span class="pre">blue,</span> <span class="pre">cyan,</span> <span class="pre">magenta,</span> <span class="pre">yellow,</span> <span class="pre">white]</span></tt> and will wrap
around if a property value larger than 7 is used. You can however
specify any other and larger colorset to be used for drawing the
property colors. The following figure shows different renderings
of the structure created by the above script. The <tt class="xref py py-func docutils literal"><span class="pre">drawNumbers()</span></tt>
function draws the element numbers (starting from 0).</p>
<div class="figure align-center" id="fig-props">
<img alt="A Formex with properties drawn as colors" src="_images/props.png" />
<p class="caption">A Formex with property numbers drawn as colors. From left to right:
wireframe, flat, flat (transparent), flatwire (transparent).</p>
</div>
<p>In flat rendering mode, the element numbers may be obscured by the
faces. In such case, you can make the numbers visible by using the
transparent mode, which can be toggled
with the <img alt="button-transparent" src="_images/transparent.png" /> button.</p>
<p>Adding properties to a Formex is often done with the sole purpose of
drawing with multiple colors. But remember you are free to use the properties
for any purpose you want. You can even save, change and restore them
throughout the lifetime of a Formex object, thus you can attibrute
multiple property sets to a Formex.</p>
</div>
<div class="section" id="getting-information-about-a-formex">
<span id="sec-formex-info"></span><h2>Getting information about a Formex<a class="headerlink" href="#getting-information-about-a-formex" title="Permalink to this headline">¶</a></h2>
<p>While the visual feedback on the canvas usually gives a good
impression of the structure you created, at times the view will not
provide enough information or not precise enough. Viewing a 3D
geometry on a 2D screen can at times even be very misleading. The most
reliable source for checking your geometry will always be the Formex
data itself. We have already seen that you can print the coordinates
of the Formex <tt class="docutils literal"><span class="pre">F</span></tt>
just by printing the Formex itself: <tt class="docutils literal"><span class="pre">print(F)</span></tt>.
Likewise you can see the property numbers from a <tt class="docutils literal"><span class="pre">print(F.prop)</span></tt> instruction.</p>
<p>But once you start using large data structures, this information may become difficult to handle.
You are usually better of with some generalized information about the Formex object.
The <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> class provides a number of methods that return such information.
The following table lists the most interesting ones.</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Function</th>
<th class="head">Return value</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="xref py py-meth docutils literal"><span class="pre">F.nelems()</span></tt></td>
<td>The number of elements in the Formex</td>
</tr>
<tr><td><tt class="xref py py-meth docutils literal"><span class="pre">F.nplex()</span></tt></td>
<td>The plexitude of the Formex (the number
of points in each element of the Formex)</td>
</tr>
<tr><td><tt class="xref py py-meth docutils literal"><span class="pre">F.bbox()</span></tt></td>
<td>The bounding box of the Formex</td>
</tr>
<tr><td><tt class="xref py py-meth docutils literal"><span class="pre">F.center()</span></tt></td>
<td>The center of the bbox of the Formex</td>
</tr>
<tr><td><tt class="xref py py-meth docutils literal"><span class="pre">F.sizes()</span></tt></td>
<td>The size of the bbox of the Formex</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="saving-images">
<span id="sec-saving-images"></span><h2>Saving images<a class="headerlink" href="#saving-images" title="Permalink to this headline">¶</a></h2>
<p>Often you will want to save an image of the created geometry to a
file, e.g. to include it in some document. This can readily be done
from the <em class="menuselection">File ‣ Save Image</em> menu. You just have to
fill in the file name and click the <em class="guilabel">Save</em> buttton.
You can specify the file format by using the appropriate extension in
the file name. The default and recommended format is <tt class="docutils literal"><span class="pre">png</span></tt>, but
pyFormex can save in commonly used bitmap formats like <tt class="docutils literal"><span class="pre">jpg</span></tt> or
<tt class="docutils literal"><span class="pre">gif</span></tt> as well.
If you have installed <tt class="docutils literal"><span class="pre">gl2ps</span></tt> (see <a class="reference internal" href="install.html#subsec-development-version"><em>Install additional software</em></a>), you can even save in a number of
vector formats, such as <tt class="docutils literal"><span class="pre">eps</span></tt> or <tt class="docutils literal"><span class="pre">svg</span></tt>.</p>
<p>But you can also create the images from inside your script. Just
import the <tt class="docutils literal"><span class="pre">image</span></tt> module and call the <tt class="docutils literal"><span class="pre">image.save()</span></tt> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">gui.image</span>
<span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;my_image.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Often you will want to change some settings, like rendering mode or
background color, to get a better looking picture.
Since the main goal of pyFormex is to automate the creation and
transformation of geometrical models, all these settings can be
changed from inside your script as well.
The following code was used to create the four images in
figure <a class="reference internal" href="#fig-props"><em>A Formex with property numbers drawn as colors. From left to right:
wireframe, flat, flat (transparent), flatwire (transparent).</em></a> above.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">gui.image</span>
<span class="n">chdir</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
<span class="n">reset</span><span class="p">()</span>
<span class="n">bgcolor</span><span class="p">(</span><span class="n">white</span><span class="p">)</span>
<span class="n">linewidth</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span>
<span class="n">canvasSize</span><span class="p">(</span><span class="mf">200</span><span class="p">,</span><span class="mf">300</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">mpattern</span><span class="p">(</span><span class="s">&#39;12-34-14-32&#39;</span><span class="p">),[</span><span class="mf">1</span><span class="p">,</span><span class="mf">3</span><span class="p">])</span>
<span class="n">F</span><span class="o">.</span><span class="n">prop</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4</span>
<span class="n">clear</span><span class="p">()</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">drawNumbers</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">wireframe</span><span class="p">()</span>
<span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;props-000.png&#39;</span><span class="p">)</span>
<span class="n">flat</span><span class="p">()</span>
<span class="n">transparent</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;props-001.png&#39;</span><span class="p">)</span>
<span class="n">transparent</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;props-002.png&#39;</span><span class="p">)</span>
<span class="n">flatwire</span><span class="p">()</span>
<span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;props-003.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The following table lists the interactive menu
option and the correspondant programmable function to be used to
change some of the most common rendering settings.</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="26%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Purpose</th>
<th class="head">Function(s)</th>
<th class="head">Menu item</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Background color</td>
<td>bgcolor()</td>
<td><em class="menuselection">Viewport ‣ Background Color</em></td>
</tr>
<tr><td>Line width</td>
<td>linewidth()</td>
<td><em class="menuselection">Viewport ‣ LineWidth</em></td>
</tr>
<tr><td>Canvas Size</td>
<td>canvasSize()</td>
<td><em class="menuselection">Viewport ‣ Canvas Size</em></td>
</tr>
<tr><td>Render Mode</td>
<td>wireframe(),
flat(), flatwire(),
smooth(), smoothwire()</td>
<td><em class="menuselection">Viewport ‣ Render Mode</em></td>
</tr>
<tr><td>Transparency</td>
<td>transparent()</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="transforming-a-formex">
<span id="sec-transform"></span><h2>Transforming a Formex<a class="headerlink" href="#transforming-a-formex" title="Permalink to this headline">¶</a></h2>
<p>Until now, we&#8217;ve only created simple Formices. The strength of
pyFormex however is the ease to generate large geometrical models by a sequence of
mathematical transformations. After creating a initial Formex, you can
transform it by creating copies, translations, rotations, projections,...</p>
<p>The <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> class has an wide range of powerful transformation methods
available, and this is not the place to treat them all. The reference manual
<a class="reference internal" href="refman.html"><em>pyFormex reference manual</em></a> describes them in detail.</p>
<p>We will illustrate the power of the <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt> transformations by
studying one of the examples included with pyFormex. The
examples can be accessed from the <em class="menuselection">Examples</em> menu
option.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you have installed multiple script directories, the
examples may be found in a submenu <em class="menuselection">Scripts ‣
Examples</em>.</p>
</div>
<p>When a script is selected from this menu, it will be executed
automatically. Select the <em class="menuselection">Examples ‣ Level ‣
Beginner ‣ Helix</em> example. You will see an image of a complex
helical frame structure:</p>
<div class="figure align-center" id="fig-helix">
<img alt="A helical frame structure" src="_images/helix.png" />
<p class="caption">A helical frame structure (Helix example)</p>
</div>
<p>Yet the geometry of this complex structure was built from the very
simple pyFormex script shown below (Use <em class="menuselection">File ‣ Edit
script</em> to load it in your editor.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></td><td class="code"><div class="highlight"><pre><span class="c">#!/usr/bin/env pyformex</span>
<span class="sd">&quot;&quot;&quot;Helix example from pyFormex&quot;&quot;&quot;</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">36</span> <span class="c"># number of cells along helix</span>
<span class="n">n</span> <span class="o">=</span> <span class="mf">10</span> <span class="c"># number of cells along circular cross section</span>
<span class="n">reset</span><span class="p">()</span>
<span class="n">setDrawOptions</span><span class="p">({</span><span class="s">&#39;clear&#39;</span><span class="p">:</span><span class="bp">True</span><span class="p">})</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">pattern</span><span class="p">(</span><span class="s">&quot;164&quot;</span><span class="p">),[</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">]);</span> <span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">replic</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0</span><span class="p">);</span> <span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">replic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1</span><span class="p">);</span> <span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="mf">1.</span><span class="p">);</span> <span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">view</span><span class="o">=</span><span class="s">&#39;iso&#39;</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cylindrical</span><span class="p">([</span><span class="mf">2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">360.</span><span class="o">/</span><span class="n">n</span><span class="p">,</span><span class="mf">1.</span><span class="p">]);</span> <span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">replic</span><span class="p">(</span><span class="mf">5</span><span class="p">,</span><span class="n">m</span><span class="o">*</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2</span><span class="p">);</span> <span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">-</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0</span><span class="p">);</span> <span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">5.</span><span class="p">);</span> <span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cylindrical</span><span class="p">([</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">1</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">360.</span><span class="o">/</span><span class="n">m</span><span class="p">,</span><span class="mf">1.</span><span class="p">]);</span> <span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">view</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The script shows all steps in the building of the helical structure.
We will explain and illustrate them one by one.
If you want to see the intermediate results in pyFormex during
execution of the script, you can set a wait time between
subsequent drawing operations with <em class="menuselection">Settings ‣ Draw
Wait Time</em>. Or alternatively, you can start the script with the
<img alt="button-step" src="_images/step.png" /> button: pyFormex will then halt before each <tt class="docutils literal"><span class="pre">draw</span></tt>
function and wait until you push the <img alt="button-step" src="_images/step.png" /> again.</p>
<p>The script starts (lines 3-4) with setting the two parameters <tt class="docutils literal"><span class="pre">m</span></tt> and <tt class="docutils literal"><span class="pre">n</span></tt>. It is
always a good idea to put constants in a variable. That makes it easy to
change the values in a single place when you want to create another
structure:
<cite>your model has become a parametric model.</cite></p>
<p>Lines 5 resets the drawing options to the defaults. It is not essential in this script but it is often a good idea to restore the defaults, in case they would have been changed by a script that was run previously.
Setting the <tt class="docutils literal"><span class="pre">clear=True</span></tt> option in line 6 makes sure the subsequent drawing instructions will remove the previous step from the canvas.</p>
<p>In line 7 we create the basic geometrical entity for this structure: a triangle consisting of three lines, which we give the properties 1, 2 and 3, so that the three lines are shown in a different color:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">pattern</span><span class="p">(</span><span class="s">&quot;164&quot;</span><span class="p">),[</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">])</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-helix-000">
<img alt="The basic Formex" src="_images/helix-000.png" />
<p class="caption">The basic Formex</p>
</div>
<p>This basic Formex is copied <tt class="docutils literal"><span class="pre">m</span></tt> times with a translation step 1.0 (this is precisely the length
of the horizontal edge of the triangle) in the 0 direction:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">replic</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-helix-001">
<img alt="Replicated in x-direction" src="_images/helix-001.png" />
<p class="caption">Replicated in x-direction</p>
</div>
<p>Then, the new  Formex
is copied <tt class="docutils literal"><span class="pre">n</span></tt> times  with the same step size in the direction 1.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">replic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-helix-002">
<img alt="Replicated in y-direction" src="_images/helix-002.png" />
<p class="caption">Replicated in y-direction</p>
</div>
<p>Now a copy of this last Formex is translated in direction &#8216;2&#8217; with a
translation step of &#8216;1&#8217;. This necessary for the transformation into a cylinder.
The result of all previous steps is a rectangular pattern with the desired
dimensions, in a plane z=1.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="mf">1</span><span class="p">);</span> <span class="n">drawit</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="s">&#39;iso&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This pattern is rolled up into a cylinder around the 2-axis.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cylindrical</span><span class="p">([</span><span class="mf">2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">360.</span><span class="o">/</span><span class="n">n</span><span class="p">,</span><span class="mf">1.</span><span class="p">]);</span> <span class="n">drawit</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="s">&#39;iso&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This cylinder is copied 5 times in the 2-direction with a translation step of
&#8216;m&#8217; (the lenght of the cylinder).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">replic</span><span class="p">(</span><span class="mf">5</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="mf">2</span><span class="p">);</span> <span class="n">drawit</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="s">&#39;iso&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The next step is to rotate this cylinder -10 degrees around the 0-axis.  This
will determine the pitch angle of the spiral.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">-</span><span class="mf">10</span><span class="p">,</span><span class="mf">0</span><span class="p">);</span> <span class="n">drawit</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="s">&#39;iso&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This last Formex is now translated in direction &#8216;0&#8217; with a translation step of
&#8216;5&#8217;.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">5</span><span class="p">);</span> <span class="n">drawit</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="s">&#39;iso&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, the Formex is rolled up, but around a different axis then before.  Due
to the pitch angle, a spiral is created. If the pitch angle would be 0  (no
rotation of -10 degrees around the 0-axis), the resulting Formex  would be a
torus.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">F</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cylindrical</span><span class="p">([</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">1</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">360.</span><span class="o">/</span><span class="n">m</span><span class="p">,</span><span class="mf">1.</span><span class="p">]);</span> <span class="n">drawit</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="s">&#39;iso&#39;</span><span class="p">)</span>
<span class="n">drawit</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="s">&#39;right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="converting-a-formex-to-a-mesh-model">
<span id="sec-femodel"></span><h2>Converting a Formex to a Mesh model<a class="headerlink" href="#converting-a-formex-to-a-mesh-model" title="Permalink to this headline">¶</a></h2>
<p>pyFormex contains other geometry models besides the Formex. The
<tt class="xref py py-class docutils literal"><span class="pre">Mesh</span></tt> model e.g. is important in exporting the geometry to finite
element (FE) programs. A Formex often contains many points with (nearly) the
same coordinates. In a Finite Element model, these points have to be merged
into a single node, to express the continuity of the material.
The <tt class="xref py py-meth docutils literal"><span class="pre">toMesh()</span></tt> method of a <tt class="xref py py-class docutils literal"><span class="pre">Formex</span></tt>
performs exactly that. It returns a  <tt class="xref py py-class docutils literal"><span class="pre">Mesh</span></tt> instance, which has
two import array attributes &#8216;coords&#8217; and &#8216;elems&#8217;:</p>
<ul class="simple">
<li>coords is a float array with shape (ncoords,3), containing the
coordinates of the merged points (nodes),</li>
<li>elems is an integer array with shape (F.nelems(),F.nplex()), describing each
element by a list of node numbers. These can be used as indices in
the coords array to find the coordinates of the node.
The elements and their nodes are in the same order as in F.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">simple</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">pattern</span><span class="p">(</span><span class="n">Pattern</span><span class="p">[</span><span class="s">&#39;cube&#39;</span><span class="p">]))</span>
<span class="n">draw</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">toMesh</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&#39;Coords&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">coords</span>
<span class="k">print</span> <span class="s">&#39;Elements&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">elems</span>
</pre></div>
</div>
<p>The output of this script are the coordinates of the unique nodes of
the Mesh, and the connectivity of the elements. The connectivity is an
integer array with the same shape as the first two dimensions of the
Formex: (F.nelems(),F.nplex()):</p>
<div class="highlight-python"><pre>Nodes
[[ 0.  0.  0.]
 [ 1.  0.  0.]
 [ 0.  1.  0.]
 [ 1.  1.  0.]
 [ 0.  0.  1.]
 [ 1.  0.  1.]
 [ 0.  1.  1.]
 [ 1.  1.  1.]]
Elements
[[0 1]
 [1 3]
 [3 2]
 [2 0]
 [0 4]
 [1 5]
 [3 7]
 [2 6]
 [4 5]
 [5 7]
 [7 6]
 [6 4]]</pre>
</div>
<p>The reverse operation of transforming a Mesh model back into a Formex
is also quite simple: <tt class="docutils literal"><span class="pre">Formex(nodes[elems])</span></tt> will indeed be identical to the
original F (within the tolerance used in merging of the nodes).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">elems</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">allclose</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">f</span><span class="p">,</span><span class="n">G</span><span class="o">.</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">allclose</span></tt> funcion in the second line tests that all coordinates in both
arrays are the same, within a small tolerance.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="http://pyformex.org/">
        <img class="logo" src="_static/pyformex_logo_small.png" alt="Logo"/>
        </a></p>
    <h3><a href="index.html">Documentation</a></h3>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pyFormex tutorial</a><ul>
<li><a class="reference internal" href="#the-philosophy">The philosophy</a></li>
<li><a class="reference internal" href="#getting-started">Getting started</a></li>
<li><a class="reference internal" href="#some-basic-python-concepts">Some basic Python concepts</a></li>
<li><a class="reference internal" href="#some-basic-numpy-concepts">Some basic NumPy concepts</a></li>
<li><a class="reference internal" href="#the-formex-data-model">The Formex data model</a></li>
<li><a class="reference internal" href="#creating-a-formex">Creating a Formex</a><ul>
<li><a class="reference internal" href="#direct-input-of-structured-coordinate-data">Direct input of structured coordinate data</a></li>
<li><a class="reference internal" href="#using-the-pattern-or-mpattern-functions">Using the <tt class="docutils literal"><span class="pre">pattern()</span></tt> or <tt class="docutils literal"><span class="pre">mpattern()</span></tt> functions</a></li>
<li><a class="reference internal" href="#reading-coordinates-from-a-file-or-a-string">Reading coordinates from a file or a string</a></li>
</ul>
</li>
<li><a class="reference internal" href="#concatenation-and-lists-of-formices">Concatenation and lists of Formices</a></li>
<li><a class="reference internal" href="#formex-property-numbers">Formex property numbers</a></li>
<li><a class="reference internal" href="#getting-information-about-a-formex">Getting information about a Formex</a></li>
<li><a class="reference internal" href="#saving-images">Saving images</a></li>
<li><a class="reference internal" href="#transforming-a-formex">Transforming a Formex</a></li>
<li><a class="reference internal" href="#converting-a-formex-to-a-mesh-model">Converting a Formex to a Mesh model</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="install.html"
                        title="previous chapter">Installing pyFormex</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="user-guide.html"
                        title="next chapter">pyFormex user guide</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="user-guide.html" title="pyFormex user guide"
             >next</a> |</li>
        <li class="right" >
          <a href="install.html" title="Installing pyFormex"
             >previous</a> |</li>
    <li><a href="http://pyformex.org/">pyFormex Home</a> &gt;</li>
    
        <li><a href="index.html">pyFormex Documentation</a> &gt;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Benedict Verhegghe.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>
  </body>
</html>