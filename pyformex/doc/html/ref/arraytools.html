


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- 
##
##  This file is part of the pyFormex project.
##  pyFormex is a tool for generating, manipulating and transforming 3D
##  geometrical models by sequences of mathematical operations.
##  Home page: http://pyformex.org
##  Project page:  http://savannah.nongnu.org/projects/pyformex/
##  Copyright (C) Benedict Verhegghe (benedict.verhegghe@ugent.be) 
##  Distributed under the GNU General Public License version 3 or later.
##
##
##  This program is free software: you can redistribute it and/or modify
##  it under the terms of the GNU General Public License as published by
##  the Free Software Foundation, either version 3 of the License, or
##  (at your option) any later version.
##
##  This program is distributed in the hope that it will be useful,
##  but WITHOUT ANY WARRANTY; without even the implied warranty of
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##  GNU General Public License for more details.
##
##  You should have received a copy of the GNU General Public License
##  along with this program.  If not, see http://www.gnu.org/licenses/.
##
-->

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3. arraytools — A collection of numerical array utilities. &mdash; pyFormex v0.8.6 documentation</title>

    <link rel="stylesheet" href="../_static/pyformex.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.8.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="pyFormex v0.8.6 documentation" href="../index.html" />
    <link rel="up" title="pyFormex reference manual" href="../refman.html" />
    <link rel="next" title="4. script — Basic pyFormex script functions" href="script.html" />
    <link rel="prev" title="2. formex — Formex algebra in Python" href="formex.html" />
<link rel="icon" type="image/png" href="_static/pyformex_fav.png" />

  </head>
  <body>

<div class="header">
  <a href="http://pyformex.org">
  <img src="http://www.nongnu.org/pyformex/_static/scallop_dome_small.png" alt="scallop dome" border="0" hspace="20" vspace="12" align="left" />
  <img src="http://www.nongnu.org/pyformex/_static/pyformex-logo-2.png" alt="pyformex logo" border="0" hspace="10" vspace="8" align="left" />
  </a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="script.html" title="4. script — Basic pyFormex script functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="formex.html" title="2. formex — Formex algebra in Python"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">pyFormex v0.8.6 documentation</a> &gt;</li>
          <li><a href="../refman.html" accesskey="U">pyFormex reference manual</a> &gt;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div align="center">

<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick"/>
<input type="hidden" name="hosted_button_id" value="P7J4AM4QULB4Q"/>
<input type="image" src="https://www.paypal.com/en_US/BE/i/btn/btn_donateCC_LG.gif" name="submit" alt="PayPal - The safer, easier way to pay online!"/>
<img alt="" border="0" src="https://www.paypal.com/nl_NL/i/scr/pixel.gif" width="1" height="1"/>
</form>

</div>
   

  <h4>Previous topic</h4>
  <p class="topless"><a href="formex.html"
                        title="previous chapter">2. <tt class="docutils literal"><span class="pre">formex</span></tt> &#8212; Formex algebra in Python</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="script.html"
                        title="next chapter">4. <tt class="docutils literal"><span class="pre">script</span></tt> &#8212; Basic pyFormex script functions</a></p>
  
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

<div align="center">
  <p>
  <a href="http://www.fsf.org/register_form?referrer=8491"><img src="http://www.nongnu.org/pyformex/_static/fsf-member8491.png" alt="[FSF Associate Member]" width="89" height="31"  /></a>
  </p>
  <p>
    <a href="http://validator.w3.org/check?uri=referer"><img
      src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0 Transitional" height="31" width="88" /></a>
  </p>
</div>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-arraytools">
<span id="arraytools-a-collection-of-numerical-array-utilities"></span><span id="sec-ref-arraytools"></span><h1>3. <a class="reference internal" href="#module-arraytools" title="arraytools: A collection of numerical array utilities."><tt class="xref py py-mod docutils literal"><span class="pre">arraytools</span></tt></a> &#8212; A collection of numerical array utilities.<a class="headerlink" href="#module-arraytools" title="Permalink to this headline">¶</a></h1>
<p>These are general utility functions that depend only on the <tt class="xref py py-mod docutils literal"><span class="pre">numpy</span></tt>
array model. All pyformex modules needing <tt class="xref py py-mod docutils literal"><span class="pre">numpy</span></tt> should import
everything from this module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">arraytools</span> <span class="kn">import</span> <span class="o">*</span> 
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">Classes</span> <span class="pre">defined</span> <span class="pre">in</span> <span class="pre">module</span> <span class="pre">arraytools</span></tt></p>
<p><tt class="docutils literal"><span class="pre">Functions</span> <span class="pre">defined</span> <span class="pre">in</span> <span class="pre">module</span> <span class="pre">arraytools</span></tt></p>
<dl class="function">
<dt id="arraytools.sind">
<tt class="descclassname">arraytools.</tt><tt class="descname">sind</tt><big>(</big><em>arg</em>, <em>angle_spec=0.017453292519943295</em><big>)</big><a class="headerlink" href="#arraytools.sind" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sine of an angle in degrees.</p>
<p>For convenience, this can also be used with an angle in radians,
by specifying <cite>angle_spec=Rad</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">sind</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">sind</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">Rad</span><span class="p">)</span>
<span class="go">0.5 0.5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.cosd">
<tt class="descclassname">arraytools.</tt><tt class="descname">cosd</tt><big>(</big><em>arg</em>, <em>angle_spec=0.017453292519943295</em><big>)</big><a class="headerlink" href="#arraytools.cosd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cosine of an angle in degrees.</p>
<p>For convenience, this can also be used with an angle in radians,
by specifying <tt class="docutils literal"><span class="pre">angle_spec=Rad</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">cosd</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span> <span class="n">cosd</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="n">Rad</span><span class="p">)</span>
<span class="go">0.5 0.5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.tand">
<tt class="descclassname">arraytools.</tt><tt class="descname">tand</tt><big>(</big><em>arg</em>, <em>angle_spec=0.017453292519943295</em><big>)</big><a class="headerlink" href="#arraytools.tand" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the tangens of an angle in degrees.</p>
<p>For convenience, this can also be used with an angle in radians,
by specifying <tt class="docutils literal"><span class="pre">angle_spec=Rad</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.arcsind">
<tt class="descclassname">arraytools.</tt><tt class="descname">arcsind</tt><big>(</big><em>arg</em>, <em>angle_spec=0.017453292519943295</em><big>)</big><a class="headerlink" href="#arraytools.arcsind" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the angle whose sine is equal to the argument.</p>
<p>By default, the angle is returned in Degrees.
Specifying <cite>angle_spec=Rad</cite> will return the angle in radians.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">arcsind</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">arcsind</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">Rad</span><span class="p">)</span>
<span class="go">30.0 1.57079632679</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.arccosd">
<tt class="descclassname">arraytools.</tt><tt class="descname">arccosd</tt><big>(</big><em>arg</em>, <em>angle_spec=0.017453292519943295</em><big>)</big><a class="headerlink" href="#arraytools.arccosd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the angle whose cosine is equal to the argument.</p>
<p>By default, the angle is returned in Degrees.
Specifying <cite>angle_spec=Rad</cite> will return the angle in radians.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">arccosd</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">arccosd</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="n">Rad</span><span class="p">)</span>
<span class="go">60.0 3.14159265359</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.arctand">
<tt class="descclassname">arraytools.</tt><tt class="descname">arctand</tt><big>(</big><em>arg</em>, <em>angle_spec=0.017453292519943295</em><big>)</big><a class="headerlink" href="#arraytools.arctand" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the angle whose tangens is equal to the argument.</p>
<p>By default, the angle is returned in Degrees.
Specifying <cite>angle_spec=Rad</cite> will return the angle in radians.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">arctand</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">arctand</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="n">Rad</span><span class="p">)</span>
<span class="go">45.0 -0.785398163397</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.arctand2">
<tt class="descclassname">arraytools.</tt><tt class="descname">arctand2</tt><big>(</big><em>sin</em>, <em>cos</em>, <em>angle_spec=0.017453292519943295</em><big>)</big><a class="headerlink" href="#arraytools.arctand2" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the angle whose sine and cosine values are given.</p>
<p>By default, the angle is returned in Degrees.
Specifying <cite>angle_spec=Rad</cite> will return the angle in radians.
This returns an angle in the range ]-180,180].</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">arctand2</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">arctand2</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span><span class="n">Rad</span><span class="p">)</span>
<span class="go">180.0 -2.35619449019</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.niceLogSize">
<tt class="descclassname">arraytools.</tt><tt class="descname">niceLogSize</tt><big>(</big><em>f</em><big>)</big><a class="headerlink" href="#arraytools.niceLogSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the smallest integer e such that 10**e &gt; abs(f).</p>
<p>This returns the number of digits before the decimal point.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="p">[</span> <span class="n">niceLogSize</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">35679.23</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.00045676</span><span class="p">]</span> <span class="p">]</span>
<span class="go">[1, 5, 0, -3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.niceNumber">
<tt class="descclassname">arraytools.</tt><tt class="descname">niceNumber</tt><big>(</big><em>f</em>, <em>below=False</em><big>)</big><a class="headerlink" href="#arraytools.niceNumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nice number close to f.</p>
<p>f is a float number, whose sign is disregarded.</p>
<p>A number close to abs(f) but having only 1 significant digit is returned.
By default, the value is above abs(f). Setting below=True returns a
value above.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span> <span class="nb">str</span><span class="p">(</span><span class="n">niceNumber</span><span class="p">(</span><span class="n">f</span><span class="p">))</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span> <span class="mf">0.0837</span><span class="p">,</span> <span class="mf">0.837</span><span class="p">,</span> <span class="mf">8.37</span><span class="p">,</span> <span class="mf">83.7</span><span class="p">,</span> <span class="mf">93.7</span><span class="p">]</span> <span class="p">]</span>
<span class="go">[&#39;0.09&#39;, &#39;0.9&#39;, &#39;9.0&#39;, &#39;90.0&#39;, &#39;100.0&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span> <span class="nb">str</span><span class="p">(</span><span class="n">niceNumber</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">below</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span> <span class="mf">0.0837</span><span class="p">,</span> <span class="mf">0.837</span><span class="p">,</span> <span class="mf">8.37</span><span class="p">,</span> <span class="mf">83.7</span><span class="p">,</span> <span class="mf">93.7</span><span class="p">]</span> <span class="p">]</span>
<span class="go">[&#39;0.08&#39;, &#39;0.8&#39;, &#39;8.0&#39;, &#39;80.0&#39;, &#39;90.0&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.dotpr">
<tt class="descclassname">arraytools.</tt><tt class="descname">dotpr</tt><big>(</big><em>A</em>, <em>B</em>, <em>axis=-1</em><big>)</big><a class="headerlink" href="#arraytools.dotpr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dot product of vectors of A and B in the direction of axis.</p>
<p>This multiplies the elements of the arrays A and B, and the sums the
result in the direction of the specified axis. Default is the last axis.
Thus, if A and B are sets of vectors in their last array direction, the
result is the dot product of vectors of A with vectors of B.
A and B should be broadcast compatible.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.33</span><span class="p">,</span><span class="mf">2.0</span><span class="p">]]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">dotpr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="go">[  8.  -1.  10.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.length">
<tt class="descclassname">arraytools.</tt><tt class="descname">length</tt><big>(</big><em>A</em>, <em>axis=-1</em><big>)</big><a class="headerlink" href="#arraytools.length" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of the vectors of A in the direction of axis.</p>
<p>The components of the vectors are stored along the specified array axis
(default axis is the last).</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.normalize">
<tt class="descclassname">arraytools.</tt><tt class="descname">normalize</tt><big>(</big><em>A</em>, <em>axis=-1</em><big>)</big><a class="headerlink" href="#arraytools.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the vectors of A in the direction of axis.</p>
<p>The components of the vectors are stored along the specified array axis
(default axis is the last).</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.projection">
<tt class="descclassname">arraytools.</tt><tt class="descname">projection</tt><big>(</big><em>A</em>, <em>B</em>, <em>axis=-1</em><big>)</big><a class="headerlink" href="#arraytools.projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (signed) length of the projection of vector of A on B.</p>
<p>The components of the vectors are stored along the specified array axis
(default axis is the last).</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.orthog">
<tt class="descclassname">arraytools.</tt><tt class="descname">orthog</tt><big>(</big><em>A</em>, <em>B</em>, <em>axis=-1</em><big>)</big><a class="headerlink" href="#arraytools.orthog" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (signed) length of the projection of vector of A on B.</p>
<p>The components of the vectors are stored along the specified array axis
(default axis is the last).</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.norm">
<tt class="descclassname">arraytools.</tt><tt class="descname">norm</tt><big>(</big><em>v</em>, <em>n=2</em><big>)</big><a class="headerlink" href="#arraytools.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return thr <cite>n</cite>-norm of the vector <cite>v</cite>.</p>
<p>Default is the quadratic norm (vector length).
<cite>n == 1</cite> returns the sum.
<tt class="docutils literal"><span class="pre">n</span> <span class="pre">&lt;=</span> <span class="pre">0</span></tt> returns the max absolute value.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.horner">
<tt class="descclassname">arraytools.</tt><tt class="descname">horner</tt><big>(</big><em>a</em>, <em>u</em><big>)</big><a class="headerlink" href="#arraytools.horner" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the value of a polynom using Horner&#8217;s rule.</p>
<p>Params:</p>
<ul class="simple">
<li><cite>a</cite>: float(n+1,nd), <cite>nd</cite>-dimensional coefficients of the polynom of
degree <cite>n</cite>, starting from lowest degree.</li>
<li><cite>u</cite>: float(nu), parametric values where the polynom is evaluated</li>
</ul>
<p>Returns:
float(nu,nd), nd-dimensional values of the polynom.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">horner</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">]],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="go">[[ 1.5  2.   2.5]</span>
<span class="go"> [ 2.   3.   4. ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.solveMany">
<tt class="descclassname">arraytools.</tt><tt class="descname">solveMany</tt><big>(</big><em>A</em>, <em>b</em>, <em>direct=True</em><big>)</big><a class="headerlink" href="#arraytools.solveMany" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve many systems of linear equations.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>A</cite>: (ndof,ndof,nsys) shaped float array.</li>
<li><cite>b</cite>: (ndof,nrhs,nsys) shaped float array.</li>
</ul>
<p>Returns: a float array <cite>x</cite> with same shape as <cite>b</cite>, where <tt class="docutils literal"><span class="pre">x[:,i,j]</span></tt>
solves the system of linear equations A[:,:,j].x[:,i,j] = b[:,i,j].</p>
<p>For ndof in [1,2,3], all solutions are by default computed directly and
simultaneously. If <tt class="docutils literal"><span class="pre">direct=False</span></tt> is specified, a general linear
equation solver is called for each system of equations. This is also the
method used if <tt class="docutils literal"><span class="pre">ndof</span> <span class="pre">&gt;</span> <span class="pre">4</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.inside">
<tt class="descclassname">arraytools.</tt><tt class="descname">inside</tt><big>(</big><em>p</em>, <em>mi</em>, <em>ma</em><big>)</big><a class="headerlink" href="#arraytools.inside" title="Permalink to this definition">¶</a></dt>
<dd><p>Return true if point p is inside bbox defined by points mi and ma</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.isClose">
<tt class="descclassname">arraytools.</tt><tt class="descname">isClose</tt><big>(</big><em>values</em>, <em>target</em>, <em>rtol=1e-05</em>, <em>atol=1e-08</em><big>)</big><a class="headerlink" href="#arraytools.isClose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array flagging the elements close to target.</p>
<p><cite>values</cite> is a float array, <cite>target</cite> is a float value.
<cite>values</cite> and <cite>target</cite> should be broadcastable to the same shape.</p>
<p>The return value is a boolean array with shape of <cite>values</cite> flagging
where the values are close to target.
Two values <cite>a</cite> and <cite>b</cite> are considered close if
<img class="math" src="../_images/math/111bff3a77cd73fc555142c0ffd7b4af849562f6.png" alt="| a - b | &lt; atol + rtol * | b |"/></p>
</dd></dl>

<dl class="function">
<dt id="arraytools.anyVector">
<tt class="descclassname">arraytools.</tt><tt class="descname">anyVector</tt><big>(</big><em>v</em><big>)</big><a class="headerlink" href="#arraytools.anyVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a 3D vector.</p>
<p>v is some data compatible with a (3)-shaped float array.
Returns v as such an array.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.unitVector">
<tt class="descclassname">arraytools.</tt><tt class="descname">unitVector</tt><big>(</big><em>v</em><big>)</big><a class="headerlink" href="#arraytools.unitVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a unit vector in the direction of v.</p>
<p><cite>v</cite> is either an integer specifying one of the global axes (0,1,2),
or a 3-element array or compatible.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.rotationMatrix">
<tt class="descclassname">arraytools.</tt><tt class="descname">rotationMatrix</tt><big>(</big><em>angle</em>, <em>axis=None</em>, <em>angle_spec=0.017453292519943295</em><big>)</big><a class="headerlink" href="#arraytools.rotationMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a rotation matrix over angle, optionally around axis.</p>
<p>The angle is specified in degrees, unless angle_spec=Rad is specified.
If axis==None (default), a 2x2 rotation matrix is returned.
Else, axis should specifying the rotation axis in a 3D world. It is either
one of 0,1,2, specifying a global axis, or a vector with 3 components
specifying an axis through the origin.
In either case a 3x3 rotation matrix is returned.
Note that:</p>
<ul class="simple">
<li>rotationMatrix(angle,[1,0,0]) == rotationMatrix(angle,0)</li>
<li>rotationMatrix(angle,[0,1,0]) == rotationMatrix(angle,1)</li>
<li>rotationMatrix(angle,[0,0,1]) == rotationMatrix(angle,2)</li>
</ul>
<p>but the latter functions calls are more efficient.
The result is returned as an array.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.rotmat">
<tt class="descclassname">arraytools.</tt><tt class="descname">rotmat</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#arraytools.rotmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a rotation matrix defined by 3 points in space.</p>
<p>x is an array of 3 points.
After applying the resulting rotation matrix to the global axes,
the 0 axis becomes // to the vecors x0-x1,
the 1 axis lies in the plane x0,x1,x2 and is orthogonal to x0-x1,
and the 3 axis is orthogonal to the plane x0,x1,x2.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.trfMatrix">
<tt class="descclassname">arraytools.</tt><tt class="descname">trfMatrix</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#arraytools.trfMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the transformation matrix from points x0 to x1.</p>
<p>x and y are each arrays of 3 non-colinear points.
The return value is a tuple of a translation vector and a rotation
matrix.
The returned translation trl and rotationmatrix rot transform the
points x thus that:</p>
<ul class="simple">
<li>point x0 coincides with point y0,</li>
<li>line x0,x1 coincides with line y0,y1</li>
<li>plane x0,x1,x2 coincides with plane y0,y1,y2</li>
</ul>
<p>The rotation is to be applied first and should be around the first
point x0. The full transformation of a Coords object is thus obtained
by</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">coords</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="n">rot</span> <span class="o">+</span> <span class="n">trl</span> <span class="o">+</span> <span class="n">x0</span>  <span class="o">=</span> <span class="n">coords</span> <span class="o">*</span> <span class="n">rot</span> <span class="o">+</span> <span class="p">(</span><span class="n">trl</span><span class="o">+</span><span class="n">x0</span><span class="o">-</span><span class="n">x0</span><span class="o">*</span><span class="n">rot</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.rotMatrix">
<tt class="descclassname">arraytools.</tt><tt class="descname">rotMatrix</tt><big>(</big><em>u, w=[0.0, 0.0, 1.0], n=3</em><big>)</big><a class="headerlink" href="#arraytools.rotMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a rotation matrix that rotates axis 0 to the given vector.</p>
<p>u is a vector representing the 
Return either a 3x3(default) or 4x4(if n==4) rotation matrix.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.rotationAnglesFromMatrix">
<tt class="descclassname">arraytools.</tt><tt class="descname">rotationAnglesFromMatrix</tt><big>(</big><em>mat</em>, <em>angle_spec=0.017453292519943295</em><big>)</big><a class="headerlink" href="#arraytools.rotationAnglesFromMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return rotation angles from rotation matrix mat.</p>
<p>This returns the three angles around the global axes 0, 1 and 2.
The angles are returned in degrees, unless angle_spec=Rad.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.vectorRotation">
<tt class="descclassname">arraytools.</tt><tt class="descname">vectorRotation</tt><big>(</big><em>vec1, vec2, upvec=[0.0, 0.0, 1.0]</em><big>)</big><a class="headerlink" href="#arraytools.vectorRotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a rotation matrix for rotating vector vec1 to vec2</p>
<p>The rotation matrix will be such that the plane of vec2 and the
rotated upvec will be parallel to the original upvec.</p>
<p>This function is like <a class="reference internal" href="#arraytools.rotMatrix" title="arraytools.rotMatrix"><tt class="xref py py-func docutils literal"><span class="pre">arraytools.rotMatrix()</span></tt></a>, but allows the
specification of vec1.
The returned matrix should be used in postmultiplication to the Coords.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.growAxis">
<tt class="descclassname">arraytools.</tt><tt class="descname">growAxis</tt><big>(</big><em>a</em>, <em>add</em>, <em>axis=-1</em>, <em>fill=0</em><big>)</big><a class="headerlink" href="#arraytools.growAxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Increase the length of a single array axis.</p>
<p>The specified axis of the array <cite>a</cite> is increased with a value <cite>add</cite> and
the new elements all get the value <cite>fill</cite>.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>a</cite>: array</li>
<li><cite>add</cite>: int
The value to add to the axis length. If &lt;= 0, the unchanged array
is returned.</li>
<li><cite>axis</cite>: int
The axis to change, default -1 (last).</li>
<li><cite>fill</cite>: int or float
The value to set the new elements to.</li>
</ul>
<dl class="docutils">
<dt>Returns:</dt>
<dd>An array with same dimension and type as <cite>a</cite>, but with a length along
<cite>axis</cite> equal to <tt class="docutils literal"><span class="pre">a.shape[axis]</span> <span class="pre">+</span> <span class="pre">add</span></tt>. The new elements all have the
value <cite>fill</cite>.</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">growAxis</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="mi">2</span><span class="p">)</span>
<span class="go">array([[1, 2, 3, 0, 0],</span>
<span class="go">       [4, 5, 6, 0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.reorderAxis">
<tt class="descclassname">arraytools.</tt><tt class="descname">reorderAxis</tt><big>(</big><em>a</em>, <em>order</em>, <em>axis=-1</em><big>)</big><a class="headerlink" href="#arraytools.reorderAxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder the planes of an array along the specified axis.</p>
<p>The elements of the array are reordered along the specified axis
according to the specified order.</p>
<p>Parameters:</p>
<ul>
<li><p class="first"><cite>a</cite>: array_like</p>
</li>
<li><p class="first"><cite>order</cite>: specifies how to reorder the elements. It is either one
of the special string values defined below, or else it is an index
holding a permutation of <cite>arange(self.nelems()</cite>. Each value specifies the
index of the old element that should be placed at its position.
Thus, the order values are the old index numbers at the position of the
new index number.</p>
<p><cite>order</cite> can also take one of the following predefined values,
resulting in the corresponding renumbering scheme being generated:</p>
<ul class="simple">
<li>&#8216;reverse&#8217;: the elements along axis are placed in reverse order</li>
<li>&#8216;random&#8217;: the elements along axis are placed in random order</li>
</ul>
</li>
</ul>
<dl class="docutils">
<dt>Returns:</dt>
<dd>An array with the same elements of self, where only the order
along the specified axis has been changed.</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">reorderAxis</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">array([[3, 1, 2],</span>
<span class="go">       [6, 4, 5]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.reverseAxis">
<tt class="descclassname">arraytools.</tt><tt class="descname">reverseAxis</tt><big>(</big><em>a</em>, <em>axis=-1</em><big>)</big><a class="headerlink" href="#arraytools.reverseAxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverse the elements along a computed axis.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">reverseAxis</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([[4, 5, 6],</span>
<span class="go">       [1, 2, 3]])</span>
</pre></div>
</div>
<p>Remark: if the axis is known in advance, it may be more efficient to use
an indexing operation, like <tt class="docutils literal"><span class="pre">a[:,::-1,:]</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="arraytools.addAxis">
<tt class="descclassname">arraytools.</tt><tt class="descname">addAxis</tt><big>(</big><em>a</em>, <em>axis=0</em><big>)</big><a class="headerlink" href="#arraytools.addAxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an additional axis with length 1 to an array.</p>
<p>The new axis is inserted before the specified one. Default is to
add it at the front.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.stack">
<tt class="descclassname">arraytools.</tt><tt class="descname">stack</tt><big>(</big><em>al</em>, <em>axis=0</em><big>)</big><a class="headerlink" href="#arraytools.stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Stack a list of arrays along a new axis.</p>
<p>al is a list of arrays all of the same shape.
The return value is a new array with one extra axis, along which the
input arrays are stacked. The position of the new axis can be specified,
and is the first axis by default.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.checkArray">
<tt class="descclassname">arraytools.</tt><tt class="descname">checkArray</tt><big>(</big><em>a</em>, <em>shape=None</em>, <em>kind=None</em>, <em>allow=None</em><big>)</big><a class="headerlink" href="#arraytools.checkArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that an array a has the correct shape and type.</p>
<p>The input <cite>a</cite> is anything that can be converted into a numpy array.
Either <cite>shape</cite> and/or <cite>kind</cite> can be specified. and will then be checked.
The dimensions where <cite>shape</cite> contains a -1 value are not checked. The
number of dimensions should match.
If <cite>kind</cite> does not match, but the value is included in <cite>allow</cite>,
conversion to the requested type is attempted.</p>
<p>Returns the array if valid; else, an error is raised.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.checkArray1D">
<tt class="descclassname">arraytools.</tt><tt class="descname">checkArray1D</tt><big>(</big><em>a</em>, <em>size=None</em>, <em>kind=None</em>, <em>allow=None</em><big>)</big><a class="headerlink" href="#arraytools.checkArray1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that an array a has the correct size and type.</p>
<p>Either size and or kind can be specified.
If kind does not match, but is included in allow, conversion to the
requested type is attempted.
Returns the array if valid.
Else, an error is raised.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.checkArrayDim">
<tt class="descclassname">arraytools.</tt><tt class="descname">checkArrayDim</tt><big>(</big><em>a</em>, <em>ndim=-1</em><big>)</big><a class="headerlink" href="#arraytools.checkArrayDim" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that an array has the correct dimensionality.</p>
<p>Returns asarray(a) if ndim &lt; 0 or a.ndim == ndim
Else, an error is raised.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.checkUniqueNumbers">
<tt class="descclassname">arraytools.</tt><tt class="descname">checkUniqueNumbers</tt><big>(</big><em>nrs</em>, <em>nmin=0</em>, <em>nmax=None</em><big>)</big><a class="headerlink" href="#arraytools.checkUniqueNumbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that an array contains a set of unique integers in a given range.</p>
<p>This functions tests that all integer numbers in the array are within the
range math:<cite>nmin &lt;= i &lt; nmax</cite></p>
<p>nrs: an integer array of any shape.
nmin: minimum allowed value. If set to None, the test is skipped.
nmax: maximum allowed value + 1! If set to None, the test is skipped.
Default range is [0,unlimited].</p>
<p>If the numbers are no unique or one of the limits is passed, an error
is raised. Else, the sorted list of unique values is returned.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.readArray">
<tt class="descclassname">arraytools.</tt><tt class="descname">readArray</tt><big>(</big><em>file</em>, <em>dtype</em>, <em>shape</em>, <em>sep=' '</em><big>)</big><a class="headerlink" href="#arraytools.readArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an array from an open file.</p>
<p>This uses <tt class="xref py py-func docutils literal"><span class="pre">numpy.fromfile()</span></tt> to read an array with known shape and
data type from an open file.
The sep parameter can be specified as in fromfile.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.writeArray">
<tt class="descclassname">arraytools.</tt><tt class="descname">writeArray</tt><big>(</big><em>file</em>, <em>array</em>, <em>sep=' '</em><big>)</big><a class="headerlink" href="#arraytools.writeArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an array to an open file.</p>
<p>This uses <tt class="xref py py-func docutils literal"><span class="pre">numpy.tofile()</span></tt> to write an array to an open file.
The sep parameter can be specified as in tofile.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.cubicEquation">
<tt class="descclassname">arraytools.</tt><tt class="descname">cubicEquation</tt><big>(</big><em>a</em>, <em>b</em>, <em>c</em>, <em>d</em><big>)</big><a class="headerlink" href="#arraytools.cubicEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve a cubiq equation using a direct method.</p>
<p>a,b,c,d are the (floating point) coefficients of a third degree
polynomial equation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>  <span class="o">+</span>  <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>  <span class="o">+</span>  <span class="n">c</span> <span class="o">*</span> <span class="n">x</span>  <span class="o">+</span>  <span class="n">d</span>   <span class="o">=</span>   <span class="mi">0</span>
</pre></div>
</div>
<p>This function computes the three roots (real and complex) of this equation
and returns full information about their kind, sorting order, occurrence
of double roots. It uses scaling of the variables to enhance the accuracy.</p>
<p>The return value is a tuple (r1,r2,r3,kind), where r1,r2 and r3 are three
float values and kind is an integer specifying the kind of roots.</p>
<p>Depending on the value of <cite>kind</cite>, the roots are defined as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">kind</th>
<th class="head">roots</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>0</td>
<td>three real roots r1 &lt; r2 &lt; r3</td>
</tr>
<tr><td>1</td>
<td>three real roots r1 &lt; r2 = r3</td>
</tr>
<tr><td>2</td>
<td>three real roots r1 = r2 &lt; r3</td>
</tr>
<tr><td>3</td>
<td>three real roots r1 = r2 = r3</td>
</tr>
<tr><td>4</td>
<td>one real root r1 and two complex conjugate roots with real
part r2 and imaginary part r3; the complex roots are thus:
r2+i*r3 en r2-i*r3, where i = sqrt(-1).</td>
</tr>
</tbody>
</table>
<p>If the coefficient a==0, a ValueError is raised.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cubicEquation</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="o">-</span><span class="mf">3.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span>
<span class="go">([1.0, 1.0, 1.0], 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.uniqueOrdered">
<tt class="descclassname">arraytools.</tt><tt class="descname">uniqueOrdered</tt><big>(</big><em>ar1</em>, <em>return_index=False</em>, <em>return_inverse=False</em><big>)</big><a class="headerlink" href="#arraytools.uniqueOrdered" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the unique elements of an array.</p>
<p>This works like numpy&#8217;s unique, but uses a stable sorting algorithm.
The returned index may therefore hold other entries for multiply
occurring values. In such case, uniqueOrdered returns the first
occurrence in the flattened array.
The unique elements and the inverse index are always the same as those
returned by numpy&#8217;s unique.</p>
<p>Parameters:</p>
<ul>
<li><dl class="first docutils">
<dt><cite>ar1</cite> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">This array will be flattened if it is not already 1-D.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>return_index</cite> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If True, also return the indices against <cite>ar1</cite> that result in the
unique array.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>return_inverse</cite> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If True, also return the indices against the unique array that
result in <cite>ar1</cite>.</p>
</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul>
<li><dl class="first docutils">
<dt><cite>unique</cite> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">The unique values.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>unique_indices</cite> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, optional</span></dt>
<dd><p class="first last">The indices of the unique values. Only provided if <cite>return_index</cite> is
True.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>unique_inverse</cite> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, optional</span></dt>
<dd><p class="first last">The indices to reconstruct the original array. Only provided if
<cite>return_inverse</cite> is True.</p>
</dd>
</dl>
</li>
</ul>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(array([1, 2, 3, 4, 5, 6, 7, 8]), array([ 7,  0,  1, 10,  3,  4,  5,  6]), array([1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 6, 7]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uniqueOrdered</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(array([1, 2, 3, 4, 5, 6, 7, 8]), array([7, 0, 1, 2, 3, 4, 5, 6]), array([1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 6, 7]))</span>
</pre></div>
</div>
<p>Notice the difference in the 4-th entry of the second array.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.renumberIndex">
<tt class="descclassname">arraytools.</tt><tt class="descname">renumberIndex</tt><big>(</big><em>index</em><big>)</big><a class="headerlink" href="#arraytools.renumberIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Renumber an index sequentially.</p>
<p>Given a one-dimensional integer array with only non-negative values,
and <cite>nval</cite> being the number of different values in it, and you want to
replace its elements with values in the range <cite>0..nval</cite>, such that
identical numbers are always replaced with the same number and the
new values at their first occurrence form an increasing sequence <cite>0..nval</cite>.
This function will give you the old numbers corresponding with each
position <cite>0..nval</cite>.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>index</cite>: array_like, 1-D, integer
An array with non-negative integer values</li>
</ul>
<dl class="docutils">
<dt>Returns:</dt>
<dd>A 1-D integer array with length equal to <cite>nval</cite>, where <cite>nval</cite>
is the number of different values in <cite>index</cite>, and holding the original
values corresponding to the new value <cite>0..nval</cite>.</dd>
<dt>Remark:</dt>
<dd>Use <a class="reference internal" href="#arraytools.inverseUniqueIndex" title="arraytools.inverseUniqueIndex"><tt class="xref py py-func docutils literal"><span class="pre">inverseUniqueIndex()</span></tt></a> to find the inverse mapping
needed to replace the values in the index by the new ones.</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">renumberIndex</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">array([0, 5, 2, 6])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inverseUniqueIndex</span><span class="p">(</span><span class="n">renumberIndex</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">]))[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="go">array([0, 1, 2, 2, 3, 0])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.inverseUniqueIndex">
<tt class="descclassname">arraytools.</tt><tt class="descname">inverseUniqueIndex</tt><big>(</big><em>index</em><big>)</big><a class="headerlink" href="#arraytools.inverseUniqueIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse an index.</p>
<p>Given a 1-D integer array with <em>unique</em> non-negative values, and
<cite>max</cite> being the highest value in it, this function returns the position
in the array of the values <cite>0..max</cite>. Values not occurring in input index
get a value -1 in the inverse index.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>index</cite>: array_like, 1-D, integer
An array with non-negative values, wihch all have to be unique.</li>
</ul>
<dl class="docutils">
<dt>Returns:</dt>
<dd>A 1-D integer array with length <cite>max+1</cite>, with the positions in
<cite>index</cite> of the values <cite>0..max</cite>, or -1 if the value does not occur in
<cite>index</cite>.</dd>
<dt>Remark:</dt>
<dd>The inverse index translates the unique index numbers in a
sequential index, so that
<tt class="docutils literal"><span class="pre">inverseUniqueIndex(index)[index]</span> <span class="pre">==</span> <span class="pre">arange(1+index.max())</span></tt>.</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">inverseUniqueIndex</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="go">array([ 0, -1,  2, -1, -1,  1,  3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inverseUniqueIndex</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">])[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="go">array([0, 1, 2, 3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.sortByColumns">
<tt class="descclassname">arraytools.</tt><tt class="descname">sortByColumns</tt><big>(</big><em>a</em><big>)</big><a class="headerlink" href="#arraytools.sortByColumns" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort an array on all its columns, from left to right.</p>
<p>The rows of a 2-dimensional array are sorted, first on the first
column, then on the second to resolve ties, etc..</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>a</cite>: array_like, 2-D</li>
</ul>
<dl class="docutils">
<dt>Returns:</dt>
<dd>A 1-D integer array specifying the order in which the rows have to
be taken to obtain an array sorted by columns.</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sortByColumns</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="go">array([0, 3, 1, 4, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.uniqueRows">
<tt class="descclassname">arraytools.</tt><tt class="descname">uniqueRows</tt><big>(</big><em>a</em>, <em>permutations=False</em><big>)</big><a class="headerlink" href="#arraytools.uniqueRows" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (the indices of) the unique rows of a 2-D array.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>a</cite>: array_like, 2-D</li>
<li><cite>permutations</cite>: bool
If True, rows which are permutations of the same data are considered
equal. The default is to consider permutations as different.</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><cite>uniq</cite>: a 1-D integer array with the numbers of the unique rows from <cite>a</cite>.
The order of the elements in <cite>uniq</cite> is determined by the sorting
procedure, which in the current implementation is <a class="reference internal" href="#arraytools.sortByColumns" title="arraytools.sortByColumns"><tt class="xref py py-func docutils literal"><span class="pre">sortByColumns()</span></tt></a>.
If <cite>permutations==True</cite>, <cite>a</cite> is sorted along its axis -1 before calling
this sorting function.</li>
<li><cite>uniqid</cite>: a 1-D integer array with length equal to <cite>a.shape[0]</cite> with the
numbers of <cite>uniq</cite> corresponding to each of the rows of <cite>a</cite>.</li>
</ul>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">uniqueRows</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="go">(array([0, 3, 1, 2]), array([0, 2, 3, 1, 2]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uniqueRows</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span><span class="n">permutations</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(array([0, 3, 1]), array([0, 2, 2, 1, 2]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.argNearestValue">
<tt class="descclassname">arraytools.</tt><tt class="descname">argNearestValue</tt><big>(</big><em>values</em>, <em>target</em><big>)</big><a class="headerlink" href="#arraytools.argNearestValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the item nearest to target.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>values</cite>: a list of float values</li>
<li><cite>target</cite>: a float value</li>
</ul>
<p>Returns: the position of the item in <cite>values</cite> that is
nearest to <cite>target</cite>.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">argNearestValue</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.9</span><span class="p">],</span><span class="mf">0.7</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.nearestValue">
<tt class="descclassname">arraytools.</tt><tt class="descname">nearestValue</tt><big>(</big><em>values</em>, <em>target</em><big>)</big><a class="headerlink" href="#arraytools.nearestValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the item nearest to target.</p>
<p><tt class="docutils literal"><span class="pre">values</span></tt>: a list of float values</p>
<p><tt class="docutils literal"><span class="pre">target</span></tt>: a single value</p>
<p>Return value: the item in <tt class="docutils literal"><span class="pre">values</span></tt> values that is
nearest to <tt class="docutils literal"><span class="pre">target</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.inverseIndex">
<tt class="descclassname">arraytools.</tt><tt class="descname">inverseIndex</tt><big>(</big><em>index</em>, <em>maxcon=4</em><big>)</big><a class="headerlink" href="#arraytools.inverseIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an inverse index.</p>
<p>An index is an array pointing at other items by their position.
The inverse index is a collection of the reverse pointers.
Negative values in the input index are disregarded.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>index</cite>: an array of integers, where only non-negative values are
meaningful, and negative values are silently ignored. A Connectivity
is a suitable argument.</li>
<li><cite>maxcon</cite>: int: an initial estimate for the maximum number of rows a
single element of index occurs at. The default will usually do well,
because the procedure will automatically enlarge it when needed.</li>
</ul>
<dl class="docutils">
<dt>Returns:</dt>
<dd><p class="first">An (mr,mc) shaped integer array where:</p>
<ul class="simple">
<li><cite>mr</cite> will be equal to the highest positive value in index, +1.</li>
<li><cite>mc</cite> will be equal to the highest row-multiplicity of any number
in <cite>index</cite>.</li>
</ul>
<p class="last">Row <cite>i</cite> of the inverse index contains all the row numbers of <cite>index</cite>
that contain the number <cite>i</cite>. Because the number of rows containing
the number <cite>i</cite> is usually not a constant, the resulting array will have
a number of columns <cite>mc</cite> corresponding to the highest row-occurrence of
any single number. Shorter rows are padded with -1 values to flag
non-existing entries.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">inverseIndex</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="go">array([[ 0,  1,  3],</span>
<span class="go">       [-1,  0,  2],</span>
<span class="go">       [-1,  1,  2],</span>
<span class="go">       [-1, -1,  3]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.matchIndex">
<tt class="descclassname">arraytools.</tt><tt class="descname">matchIndex</tt><big>(</big><em>target</em>, <em>values</em><big>)</big><a class="headerlink" href="#arraytools.matchIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Find position of values in target.</p>
<p>This function finds the position in the array <cite>target</cite> of the elements
from the array <cite>values</cite>.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>target</cite>: an index array with all non-negative values. If not 1-D, it
will be flattened.</li>
<li><cite>values</cite>: an index array with all non-negative values. If not 1-D, it
will be flattened.</li>
</ul>
<p>Returns: an index array with the same size as <cite>values</cite>.
For each number in <cite>values</cite>, the index contains the position of that value
in the flattened <cite>target</cite>, or -1 if that number does not occur in <cite>target</cite>.
If an element from <cite>values</cite> occurs more than once in <cite>target</cite>, it is
currently undefined which of those positions is returned.</p>
<p>Remark that after <tt class="docutils literal"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">matchIndex(target,values)</span></tt> the equality
<tt class="docutils literal"><span class="pre">values[m]</span> <span class="pre">==</span> <span class="pre">target</span></tt> holds in all the non-negative positions of <cite>m</cite>.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matchIndex</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="go">array([-1, -1,  4,  0, -1])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.groupArgmin">
<tt class="descclassname">arraytools.</tt><tt class="descname">groupArgmin</tt><big>(</big><em>val</em>, <em>gid</em><big>)</big><a class="headerlink" href="#arraytools.groupArgmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the group minimum</p>
<p>Computes the minimum value per group of a set of values tagged with
a group number.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>val</cite>: (nval,) shaped array of values</li>
<li><cite>gid</cite>: (nval,) shaped int array of group identifiers</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><cite>ugid</cite>: (ngrp,) shaped int array with unique group identifiers</li>
<li><cite>minpos</cite>: (ngrp,p) shape int array giving the position in <cite>val</cite> of
the minimum of all values with the corresponding group identifier
in <cite>ugid</cite>.</li>
</ul>
<p>After return, the minimum values corresponding to the groups in <cite>ugid</cite>
are given by <tt class="docutils literal"><span class="pre">val[minpos]</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gid</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">groupArgmin</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">gid</span><span class="p">)</span>
<span class="go">(array([1, 2, 6]), array([5, 0, 3]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.vectorLength">
<tt class="descclassname">arraytools.</tt><tt class="descname">vectorLength</tt><big>(</big><em>vec</em><big>)</big><a class="headerlink" href="#arraytools.vectorLength" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lengths of a set of vectors.</p>
<p>vec is an (n,3) shaped array holding a collection of vectors.
The result is an (n,) shaped array with the length of each vector.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.vectorNormalize">
<tt class="descclassname">arraytools.</tt><tt class="descname">vectorNormalize</tt><big>(</big><em>vec</em><big>)</big><a class="headerlink" href="#arraytools.vectorNormalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize a set of vectors.</p>
<p>vec is a (n,3) shaped arrays holding a collection of vectors.
The result is a tuple of two arrays:</p>
<ul class="simple">
<li>length (n): the length of the vectors vec</li>
<li>normal (n,3): unit-length vectors along vec.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="arraytools.vectorPairAreaNormals">
<tt class="descclassname">arraytools.</tt><tt class="descname">vectorPairAreaNormals</tt><big>(</big><em>vec1</em>, <em>vec2</em><big>)</big><a class="headerlink" href="#arraytools.vectorPairAreaNormals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute area of and normals on parallellograms formed by vec1 and vec2.</p>
<p>vec1 and vec2 are (n,3) shaped arrays holding collections of vectors.
The result is a tuple of two arrays:</p>
<ul class="simple">
<li>area (n) : the area of the parallellogram formed by vec1 and vec2.</li>
<li>normal (n,3) : (normalized) vectors normal to each couple (vec1,2).</li>
</ul>
<p>These are calculated from the cross product of vec1 and vec2, which indeed
gives area * normal.</p>
<p>Note that where two vectors are parallel, an area zero results and
an axis with components NaN.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.vectorPairArea">
<tt class="descclassname">arraytools.</tt><tt class="descname">vectorPairArea</tt><big>(</big><em>vec1</em>, <em>vec2</em><big>)</big><a class="headerlink" href="#arraytools.vectorPairArea" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute area of the parallellogram formed by a vector pair vec1,vec2.</p>
<p>vec1 and vec2 are (n,3) shaped arrays holding collections of vectors.
The result is an (n) shaped array with the area of the parallellograms
formed by each pair of vectors (vec1,vec2).</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.vectorPairNormals">
<tt class="descclassname">arraytools.</tt><tt class="descname">vectorPairNormals</tt><big>(</big><em>vec1</em>, <em>vec2</em><big>)</big><a class="headerlink" href="#arraytools.vectorPairNormals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute vectors normal to vec1 and vec2.</p>
<p>vec1 and vec2 are (n,3) shaped arrays holding collections of vectors.
The result is an (n,3) shaped array of unit length vectors normal to
each couple (edg1,edg2).</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.vectorTripleProduct">
<tt class="descclassname">arraytools.</tt><tt class="descname">vectorTripleProduct</tt><big>(</big><em>vec1</em>, <em>vec2</em>, <em>vec3</em><big>)</big><a class="headerlink" href="#arraytools.vectorTripleProduct" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute triple product vec1 . (vec2 x vec3).</p>
<p>vec1, vec2, vec3 are (n,3) shaped arrays holding collections of vectors.
The result is a (n,) shaped array with the triple product of each set
of corresponding vectors from vec1,vec2,vec3.
This is also the square of the volume of the parallellepid formex by
the 3 vectors.
If vec1 is a unit normal, the result is also the area of the parallellogram
(vec2,vec3) projected in the direction vec1.</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.vectorPairCosAngle">
<tt class="descclassname">arraytools.</tt><tt class="descname">vectorPairCosAngle</tt><big>(</big><em>v1</em>, <em>v2</em><big>)</big><a class="headerlink" href="#arraytools.vectorPairCosAngle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cosinus of the angle between the vectors v1 and v2.</p>
<p>vec1 and vec2 are (n,3) shaped arrays holding collections of vectors.
The result is an (n) shaped array with the cosinus of the angle between
each pair of vectors (vec1,vec2).</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.vectorPairAngle">
<tt class="descclassname">arraytools.</tt><tt class="descname">vectorPairAngle</tt><big>(</big><em>v1</em>, <em>v2</em><big>)</big><a class="headerlink" href="#arraytools.vectorPairAngle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the angle (in radians) between the vectors v1 and v2.</p>
<p>vec1 and vec2 are (n,3) shaped arrays holding collections of vectors.
The result is an (n) shaped array with the angle between
each pair of vectors (vec1,vec2).</p>
</dd></dl>

<dl class="function">
<dt id="arraytools.histogram2">
<tt class="descclassname">arraytools.</tt><tt class="descname">histogram2</tt><big>(</big><em>a</em>, <em>bins</em>, <em>range=None</em><big>)</big><a class="headerlink" href="#arraytools.histogram2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the histogram of a set of data.</p>
<p>This function is a like numpy&#8217;s histogram function, but also returns
the bin index for each individual entry in the data set.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>a</cite>: array_like.
Input data. The histogram is computed over the flattened array.</li>
<li><cite>bins</cite>: int or sequence of scalars.
If bins is an int, it defines the number of equal-width bins
in the given range. If bins is a sequence, it defines the bin edges,
allowing for non-uniform bin widths. Both the leftmost and rightmost
edges are included, thus the number of bins is len(bins)-1.</li>
<li><cite>range</cite>: (float, float), optional. The lower and upper range of the bins.
If not provided, range is simply (a.min(), a.max()). Values outside the
range are ignored. This parameter is ignored if bins is a sequence.</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><cite>hist</cite>: integer array with length nbins, holding the number of elements
in each bin,</li>
<li><cite>ind</cite>: a sequence of nbins integer arrays, each holding the indices of
the elements fitting in the respective bins,</li>
<li><cite>xbins</cite>: array of same type as data and with length nbins+1:
returns the bin edges.</li>
</ul>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">histogram2</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="go">(array([2, 2, 2, 1]), [array([0, 6]), array([1, 4]), array([2, 5]), array([3])], array([1, 2, 3, 4, 5]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.movingView">
<tt class="descclassname">arraytools.</tt><tt class="descname">movingView</tt><big>(</big><em>a</em>, <em>size</em><big>)</big><a class="headerlink" href="#arraytools.movingView" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a moving view along the first axis of an array</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>a</cite> : array_like: array for wihch to create a moving view</li>
<li><cite>size</cite> : int: size of the moving view</li>
</ul>
<p>Returns:</p>
<p>An array that is a view of the original array with an extra first
axis of length w.</p>
<p>Using swapaxes(0,axis) moving views over any axis can be created.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">x</span>
<span class="go">[[0 1]</span>
<span class="go"> [2 3]</span>
<span class="go"> [4 5]</span>
<span class="go"> [6 7]</span>
<span class="go"> [8 9]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">movingView</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[[[0 1]</span>
<span class="go">  [2 3]</span>
<span class="go">  [4 5]]</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go"> [[2 3]</span>
<span class="go">  [4 5]</span>
<span class="go">  [6 7]]</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go"> [[4 5]</span>
<span class="go">  [6 7]</span>
<span class="go">  [8 9]]]</span>
</pre></div>
</div>
<p>Calculate rolling sum of first axis:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">movingView</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[[ 6  9]</span>
<span class="go"> [12 15]</span>
<span class="go"> [18 21]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.movingAverage">
<tt class="descclassname">arraytools.</tt><tt class="descname">movingAverage</tt><big>(</big><em>a</em>, <em>n</em>, <em>m0=None</em>, <em>m1=None</em><big>)</big><a class="headerlink" href="#arraytools.movingAverage" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the moving average along the first axis of an array.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>a</cite> : array_like: array to be averaged</li>
<li><cite>n</cite> : int: moving sample size</li>
<li><cite>m0</cite> : optional, int: if specified, the first data set of a will
be prepended this number of times</li>
<li><cite>m1</cite> : optional, int: if specified, the last data set of a will
be appended this number of times</li>
</ul>
<p>Returns:</p>
<p>An array with the moving average over n data sets along the first axis of a.
The array has the same shape as a, except possibly for the length of the
first axis.
If neither m0 nor m1 are set, the first axis will have a length of
a.shape[0] - (n-1).
If both m0 and m1 are give, the first axis will have a length of
a.shape[0] - (n-1) + m0 + m1. 
If either m0 or m1 are set and the other not, the missing value m0 or m1
will be computed thus that the return array has a first axis with length
a.shape[0].</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">movingAverage</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[[ 2.  3.]</span>
<span class="go"> [ 4.  5.]</span>
<span class="go"> [ 6.  7.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">movingAverage</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[[ 0.          1.        ]</span>
<span class="go"> [ 0.66666667  1.66666667]</span>
<span class="go"> [ 2.          3.        ]</span>
<span class="go"> [ 4.          5.        ]</span>
<span class="go"> [ 6.          7.        ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="arraytools.randomNoise">
<tt class="descclassname">arraytools.</tt><tt class="descname">randomNoise</tt><big>(</big><em>shape</em>, <em>min=0.0</em>, <em>max=1.0</em><big>)</big><a class="headerlink" href="#arraytools.randomNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an array with random values between min and max</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="script.html" title="4. script — Basic pyFormex script functions"
             >next</a> |</li>
        <li class="right" >
          <a href="formex.html" title="2. formex — Formex algebra in Python"
             >previous</a> |</li>
        <li><a href="../index.html">pyFormex v0.8.6 documentation</a> &gt;</li>
          <li><a href="../refman.html" >pyFormex reference manual</a> &gt;</li> 
      </ul>
    </div>
    <div class="footer">
    <span class="left">
        &copy; Copyright 2004-2011, Benedict Verhegghe.
    </span>
      Last updated on Jan 16, 2012.
    <span class="right">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.8.
    </span>
    </div>
  </body>
</html>
